<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 Strings, Dates, and Tidying | Engineering Data Analysis in R</title>
  <meta name="description" content="This is an undergraduate technical elective course for mechanical engineers who wish to lean about data analysis using the R programming language." />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 Strings, Dates, and Tidying | Engineering Data Analysis in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an undergraduate technical elective course for mechanical engineers who wish to lean about data analysis using the R programming language." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 Strings, Dates, and Tidying | Engineering Data Analysis in R" />
  
  <meta name="twitter:description" content="This is an undergraduate technical elective course for mechanical engineers who wish to lean about data analysis using the R programming language." />
  

<meta name="author" content="John Volckens" />


<meta name="date" content="2023-08-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="eda1.html"/>
<link rel="next" href="eda2.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Engineering Data Analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.1</b> How to use this book</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#grading"><i class="fa fa-check"></i><b>1.3</b> Grading</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#grading-for-mech-476"><i class="fa fa-check"></i><b>1.3.1</b> Grading for MECH 476</a></li>
<li class="chapter" data-level="1.3.2" data-path="index.html"><a href="index.html#homework-submission"><i class="fa fa-check"></i><b>1.3.2</b> Homework submission</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-set-up"><i class="fa fa-check"></i><b>1.4</b> Course set-up</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#install-r-and-rstudio"><i class="fa fa-check"></i><b>1.4.1</b> Install R and RStudio</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#install-git-and-create-a-github-account"><i class="fa fa-check"></i><b>1.4.2</b> Install Git and create a GitHub account</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#connect-git-github-and-rstudio"><i class="fa fa-check"></i><b>1.4.3</b> Connect Git, GitHub, and RStudio</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#create-new-project-github-first"><i class="fa fa-check"></i><b>1.4.4</b> Create new project, GitHub first</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#use-rstudiogithub-system-for-homework-submission"><i class="fa fa-check"></i><b>1.4.5</b> Use RStudio/GitHub system for homework submission</a></li>
<li class="chapter" data-level="1.4.6" data-path="index.html"><a href="index.html#confirm-successful-set-up"><i class="fa fa-check"></i><b>1.4.6</b> Confirm successful set-up</a></li>
<li class="chapter" data-level="1.4.7" data-path="index.html"><a href="index.html#asking-for-help-properly"><i class="fa fa-check"></i><b>1.4.7</b> Asking for help (properly)</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#coursebook"><i class="fa fa-check"></i><b>1.5</b> Coursebook</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#other-helpful-books-not-required"><i class="fa fa-check"></i><b>1.5.1</b> Other helpful books (not required)</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rprog1.html"><a href="rprog1.html"><i class="fa fa-check"></i><b>2</b> The R Programming Environment</a>
<ul>
<li class="chapter" data-level="2.1" data-path="rprog1.html"><a href="rprog1.html#ch.-2-objectives"><i class="fa fa-check"></i><b>2.1</b> Ch. 2 Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="rprog1.html"><a href="rprog1.html#r-and-r-studio"><i class="fa fa-check"></i><b>2.2</b> R and R Studio</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="rprog1.html"><a href="rprog1.html#what-is-r"><i class="fa fa-check"></i><b>2.2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2.2" data-path="rprog1.html"><a href="rprog1.html#free-and-open-source-software"><i class="fa fa-check"></i><b>2.2.2</b> Free and open-source software</a></li>
<li class="chapter" data-level="2.2.3" data-path="rprog1.html"><a href="rprog1.html#what-is-rstudio"><i class="fa fa-check"></i><b>2.2.3</b> What is RStudio?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="rprog1.html"><a href="rprog1.html#communicating-with-r"><i class="fa fa-check"></i><b>2.3</b> Communicating with R</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="rprog1.html"><a href="rprog1.html#r-sessions-console-and-command-prompt"><i class="fa fa-check"></i><b>2.3.1</b> R sessions, console, and command prompt</a></li>
<li class="chapter" data-level="2.3.2" data-path="rprog1.html"><a href="rprog1.html#r-expressions-function-calls-and-objects"><i class="fa fa-check"></i><b>2.3.2</b> R expressions, function calls, and objects</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rprog1.html"><a href="rprog1.html#r-scripts"><i class="fa fa-check"></i><b>2.4</b> R scripts</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="rprog1.html"><a href="rprog1.html#commenting-code"><i class="fa fa-check"></i><b>2.4.1</b> Commenting code</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rprog1.html"><a href="rprog1.html#the-package-system"><i class="fa fa-check"></i><b>2.5</b> The “package” system</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="rprog1.html"><a href="rprog1.html#r-packages"><i class="fa fa-check"></i><b>2.5.1</b> R packages</a></li>
<li class="chapter" data-level="2.5.2" data-path="rprog1.html"><a href="rprog1.html#installing-from-cran"><i class="fa fa-check"></i><b>2.5.2</b> Installing from CRAN</a></li>
<li class="chapter" data-level="2.5.3" data-path="rprog1.html"><a href="rprog1.html#loading-an-installed-package"><i class="fa fa-check"></i><b>2.5.3</b> Loading an installed package</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rprog1.html"><a href="rprog1.html#rs-most-basic-object-types"><i class="fa fa-check"></i><b>2.6</b> R’s most basic object types</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="rprog1.html"><a href="rprog1.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="rprog1.html"><a href="rprog1.html#dataframes"><i class="fa fa-check"></i><b>2.6.2</b> Dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="rprog1.html"><a href="rprog1.html#chapter-2-exercises"><i class="fa fa-check"></i><b>2.7</b> Chapter 2 Exercises</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="rprog1.html"><a href="rprog1.html#set-1-session-helpfiles-scripts-and-objects"><i class="fa fa-check"></i><b>2.7.1</b> Set 1: Session, helpfiles, scripts, and objects</a></li>
<li class="chapter" data-level="2.7.2" data-path="rprog1.html"><a href="rprog1.html#set-2-loading-and-using-packages"><i class="fa fa-check"></i><b>2.7.2</b> Set 2: Loading and using packages</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="rprog1.html"><a href="rprog1.html#chapter-2-homework"><i class="fa fa-check"></i><b>2.8</b> Chapter 2 Homework</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="rprog1.html"><a href="rprog1.html#special-swirl-commands"><i class="fa fa-check"></i><b>2.8.1</b> Special <code>swirl</code> commands</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rprog2.html"><a href="rprog2.html"><i class="fa fa-check"></i><b>3</b> Getting and Cleaning Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="rprog2.html"><a href="rprog2.html#ch.-3-objectives"><i class="fa fa-check"></i><b>3.1</b> Ch. 3 Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="rprog2.html"><a href="rprog2.html#overview"><i class="fa fa-check"></i><b>3.2</b> Overview</a></li>
<li class="chapter" data-level="3.3" data-path="rprog2.html"><a href="rprog2.html#reading-data-into-r"><i class="fa fa-check"></i><b>3.3</b> Reading data into R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="rprog2.html"><a href="rprog2.html#reading-local-flat-files"><i class="fa fa-check"></i><b>3.3.1</b> Reading local flat files</a></li>
<li class="chapter" data-level="3.3.2" data-path="rprog2.html"><a href="rprog2.html#reading-in-other-file-types"><i class="fa fa-check"></i><b>3.3.2</b> Reading in other file types</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="rprog2.html"><a href="rprog2.html#directories-and-pathnames"><i class="fa fa-check"></i><b>3.4</b> Directories and pathnames</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="rprog2.html"><a href="rprog2.html#directory-structure"><i class="fa fa-check"></i><b>3.4.1</b> Directory structure</a></li>
<li class="chapter" data-level="3.4.2" data-path="rprog2.html"><a href="rprog2.html#working-directory"><i class="fa fa-check"></i><b>3.4.2</b> Working directory</a></li>
<li class="chapter" data-level="3.4.3" data-path="rprog2.html"><a href="rprog2.html#file-and-directory-pathnames"><i class="fa fa-check"></i><b>3.4.3</b> File and directory pathnames</a></li>
<li class="chapter" data-level="3.4.4" data-path="rprog2.html"><a href="rprog2.html#tangent-paste"><i class="fa fa-check"></i><b>3.4.4</b> Tangent: <code>paste</code></a></li>
<li class="chapter" data-level="3.4.5" data-path="rprog2.html"><a href="rprog2.html#reading-online-flat-files"><i class="fa fa-check"></i><b>3.4.5</b> Reading online flat files</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="rprog2.html"><a href="rprog2.html#data-cleaning"><i class="fa fa-check"></i><b>3.5</b> Data cleaning</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="rprog2.html"><a href="rprog2.html#renaming-columns"><i class="fa fa-check"></i><b>3.5.1</b> Renaming columns</a></li>
<li class="chapter" data-level="3.5.2" data-path="rprog2.html"><a href="rprog2.html#selecting-columns"><i class="fa fa-check"></i><b>3.5.2</b> Selecting columns</a></li>
<li class="chapter" data-level="3.5.3" data-path="rprog2.html"><a href="rprog2.html#add-or-change-columns"><i class="fa fa-check"></i><b>3.5.3</b> Add or change columns</a></li>
<li class="chapter" data-level="3.5.4" data-path="rprog2.html"><a href="rprog2.html#base-r-equivalents-to-dplyr-functions"><i class="fa fa-check"></i><b>3.5.4</b> Base R equivalents to <code>dplyr</code> functions</a></li>
<li class="chapter" data-level="3.5.5" data-path="rprog2.html"><a href="rprog2.html#filtering-to-certain-rows"><i class="fa fa-check"></i><b>3.5.5</b> Filtering to certain rows</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="rprog2.html"><a href="rprog2.html#merging-data-frames"><i class="fa fa-check"></i><b>3.6</b> Merging Data Frames</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="rprog2.html"><a href="rprog2.html#row-binding"><i class="fa fa-check"></i><b>3.6.1</b> Row Binding</a></li>
<li class="chapter" data-level="3.6.2" data-path="rprog2.html"><a href="rprog2.html#column-binding-_join"><i class="fa fa-check"></i><b>3.6.2</b> Column Binding (_join)</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="rprog2.html"><a href="rprog2.html#piping"><i class="fa fa-check"></i><b>3.7</b> Piping</a></li>
<li class="chapter" data-level="3.8" data-path="rprog2.html"><a href="rprog2.html#markdowns"><i class="fa fa-check"></i><b>3.8</b> Markdowns</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="rprog2.html"><a href="rprog2.html#r-markdowns"><i class="fa fa-check"></i><b>3.8.1</b> R Markdowns</a></li>
<li class="chapter" data-level="3.8.2" data-path="rprog2.html"><a href="rprog2.html#header"><i class="fa fa-check"></i><b>3.8.2</b> Header</a></li>
<li class="chapter" data-level="3.8.3" data-path="rprog2.html"><a href="rprog2.html#text"><i class="fa fa-check"></i><b>3.8.3</b> Text</a></li>
<li class="chapter" data-level="3.8.4" data-path="rprog2.html"><a href="rprog2.html#code-chunks"><i class="fa fa-check"></i><b>3.8.4</b> Code Chunks</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="rprog2.html"><a href="rprog2.html#chapter-3-exercises"><i class="fa fa-check"></i><b>3.9</b> Chapter 3 Exercises</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="rprog2.html"><a href="rprog2.html#set-1-pathnames-and-data-import"><i class="fa fa-check"></i><b>3.9.1</b> Set 1: Pathnames and data import</a></li>
<li class="chapter" data-level="3.9.2" data-path="rprog2.html"><a href="rprog2.html#set-2-data-wrangling-and-piping"><i class="fa fa-check"></i><b>3.9.2</b> Set 2: Data wrangling and piping</a></li>
<li class="chapter" data-level="3.9.3" data-path="rprog2.html"><a href="rprog2.html#set-3-r-markdown"><i class="fa fa-check"></i><b>3.9.3</b> Set 3: R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="rprog2.html"><a href="rprog2.html#chapter-3-homework"><i class="fa fa-check"></i><b>3.10</b> Chapter 3 Homework</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>4</b> Data Visualization with <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="4.1" data-path="dataviz.html"><a href="dataviz.html#chapter-4-objectives"><i class="fa fa-check"></i><b>4.1</b> Chapter 4 Objectives</a></li>
<li class="chapter" data-level="4.2" data-path="dataviz.html"><a href="dataviz.html#install-and-load-ggplot2"><i class="fa fa-check"></i><b>4.2</b> Install and load <code>ggplot2</code></a></li>
<li class="chapter" data-level="4.3" data-path="dataviz.html"><a href="dataviz.html#steps-to-create-a-ggplot2-object"><i class="fa fa-check"></i><b>4.3</b> Steps to create a <code>ggplot2</code> object</a></li>
<li class="chapter" data-level="4.4" data-path="dataviz.html"><a href="dataviz.html#initializing-a-ggplot2-object"><i class="fa fa-check"></i><b>4.4</b> Initializing a <code>ggplot2</code> object</a></li>
<li class="chapter" data-level="4.5" data-path="dataviz.html"><a href="dataviz.html#plot-aesthetics"><i class="fa fa-check"></i><b>4.5</b> Plot aesthetics</a></li>
<li class="chapter" data-level="4.6" data-path="dataviz.html"><a href="dataviz.html#adding-geoms"><i class="fa fa-check"></i><b>4.6</b> Adding geoms</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="dataviz.html"><a href="dataviz.html#aesthetic-override-a-warning"><i class="fa fa-check"></i><b>4.6.1</b> Aesthetic override: a warning</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="dataviz.html"><a href="dataviz.html#shapes-and-colors"><i class="fa fa-check"></i><b>4.7</b> Shapes and colors</a></li>
<li class="chapter" data-level="4.8" data-path="dataviz.html"><a href="dataviz.html#scales-useful-plot-edits"><i class="fa fa-check"></i><b>4.8</b> Scales: useful plot edits</a></li>
<li class="chapter" data-level="4.9" data-path="dataviz.html"><a href="dataviz.html#ggplot2-example-1"><i class="fa fa-check"></i><b>4.9</b> <code>ggplot2</code> example 1</a></li>
<li class="chapter" data-level="4.10" data-path="dataviz.html"><a href="dataviz.html#ggplot2-example-2"><i class="fa fa-check"></i><b>4.10</b> <code>ggplot2</code> example 2</a></li>
<li class="chapter" data-level="4.11" data-path="dataviz.html"><a href="dataviz.html#store-and-save-ggplot2-objects"><i class="fa fa-check"></i><b>4.11</b> Store and save <code>ggplot2</code> objects</a></li>
<li class="chapter" data-level="4.12" data-path="dataviz.html"><a href="dataviz.html#getting-help-with-ggplot2"><i class="fa fa-check"></i><b>4.12</b> Getting help with <code>ggplot2</code></a></li>
<li class="chapter" data-level="4.13" data-path="dataviz.html"><a href="dataviz.html#chapter-4-homework"><i class="fa fa-check"></i><b>4.13</b> Chapter 4 Homework</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="eda1.html"><a href="eda1.html"><i class="fa fa-check"></i><b>5</b> Univariate Data Exploration</a>
<ul>
<li class="chapter" data-level="5.1" data-path="eda1.html"><a href="eda1.html#ch.-5-objectives"><i class="fa fa-check"></i><b>5.1</b> Ch. 5 Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="eda1.html"><a href="eda1.html#univar"><i class="fa fa-check"></i><b>5.2</b> Univariate Data</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="eda1.html"><a href="eda1.html#location-dispersion-and-shape"><i class="fa fa-check"></i><b>5.2.1</b> Location, Dispersion, and Shape</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="eda1.html"><a href="eda1.html#quantile"><i class="fa fa-check"></i><b>5.3</b> Quantiles</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="eda1.html"><a href="eda1.html#descriptive-statistics"><i class="fa fa-check"></i><b>5.3.1</b> Descriptive Statistics</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="eda1.html"><a href="eda1.html#univariate-data-visualization"><i class="fa fa-check"></i><b>5.4</b> Univariate Data Visualization</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="eda1.html"><a href="eda1.html#summary-vs.-enumerative-plots"><i class="fa fa-check"></i><b>5.4.1</b> Summary vs. Enumerative Plots</a></li>
<li class="chapter" data-level="5.4.2" data-path="eda1.html"><a href="eda1.html#cumulative-distribution-plot"><i class="fa fa-check"></i><b>5.4.2</b> Cumulative Distribution Plot</a></li>
<li class="chapter" data-level="5.4.3" data-path="eda1.html"><a href="eda1.html#hist"><i class="fa fa-check"></i><b>5.4.3</b> Histogram</a></li>
<li class="chapter" data-level="5.4.4" data-path="eda1.html"><a href="eda1.html#box"><i class="fa fa-check"></i><b>5.4.4</b> Boxplot</a></li>
<li class="chapter" data-level="5.4.5" data-path="eda1.html"><a href="eda1.html#time_series"><i class="fa fa-check"></i><b>5.4.5</b> Time-Series Plot</a></li>
<li class="chapter" data-level="5.4.6" data-path="eda1.html"><a href="eda1.html#autocorr"><i class="fa fa-check"></i><b>5.4.6</b> Autocorrelation Plot</a></li>
<li class="chapter" data-level="5.4.7" data-path="eda1.html"><a href="eda1.html#partial-autocorrelation-plot"><i class="fa fa-check"></i><b>5.4.7</b> Partial Autocorrelation Plot</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="eda1.html"><a href="eda1.html#exploring-data"><i class="fa fa-check"></i><b>5.5</b> Exploring Data</a></li>
<li class="chapter" data-level="5.6" data-path="eda1.html"><a href="eda1.html#chapter-5-homework"><i class="fa fa-check"></i><b>5.6</b> Chapter 5 Homework</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rprog3.html"><a href="rprog3.html"><i class="fa fa-check"></i><b>6</b> Strings, Dates, and Tidying</a>
<ul>
<li class="chapter" data-level="6.1" data-path="rprog3.html"><a href="rprog3.html#chapter-6-objectives"><i class="fa fa-check"></i><b>6.1</b> Chapter 6 Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="rprog3.html"><a href="rprog3.html#strings"><i class="fa fa-check"></i><b>6.2</b> Strings</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="rprog3.html"><a href="rprog3.html#string-detect-match-subset"><i class="fa fa-check"></i><b>6.2.1</b> String detect, match, subset</a></li>
<li class="chapter" data-level="6.2.2" data-path="rprog3.html"><a href="rprog3.html#regular-expressions"><i class="fa fa-check"></i><b>6.2.2</b> Regular Expressions</a></li>
<li class="chapter" data-level="6.2.3" data-path="rprog3.html"><a href="rprog3.html#string-split-replace"><i class="fa fa-check"></i><b>6.2.3</b> String split, replace</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="rprog3.html"><a href="rprog3.html#dates-and-date-times"><i class="fa fa-check"></i><b>6.3</b> Dates and Date-times</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="rprog3.html"><a href="rprog3.html#dates-and-times-in-base-r"><i class="fa fa-check"></i><b>6.3.1</b> Dates and Times in base R</a></li>
<li class="chapter" data-level="6.3.2" data-path="rprog3.html"><a href="rprog3.html#date-time-formats"><i class="fa fa-check"></i><b>6.3.2</b> Date-time formats</a></li>
<li class="chapter" data-level="6.3.3" data-path="rprog3.html"><a href="rprog3.html#date-time-classes-in-r"><i class="fa fa-check"></i><b>6.3.3</b> Date-time classes in R</a></li>
<li class="chapter" data-level="6.3.4" data-path="rprog3.html"><a href="rprog3.html#reading-and-classifying-date-times"><i class="fa fa-check"></i><b>6.3.4</b> Reading and classifying date-times</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="rprog3.html"><a href="rprog3.html#lubridate"><i class="fa fa-check"></i><b>6.4</b> <code>lubridate</code></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="rprog3.html"><a href="rprog3.html#parsing-functions-in-lubridate"><i class="fa fa-check"></i><b>6.4.1</b> Parsing functions in <code>lubridate</code></a></li>
<li class="chapter" data-level="6.4.2" data-path="rprog3.html"><a href="rprog3.html#date-time-manipulation-with-lubridate"><i class="fa fa-check"></i><b>6.4.2</b> Date-time manipulation with <code>lubridate</code></a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="rprog3.html"><a href="rprog3.html#tidy-data"><i class="fa fa-check"></i><b>6.5</b> Tidy Data</a></li>
<li class="chapter" data-level="6.6" data-path="rprog3.html"><a href="rprog3.html#chapter-6-exercises"><i class="fa fa-check"></i><b>6.6</b> Chapter 6 Exercises</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="rprog3.html"><a href="rprog3.html#set-1-data-import-and-manipulation"><i class="fa fa-check"></i><b>6.6.1</b> Set 1: Data import and manipulation</a></li>
<li class="chapter" data-level="6.6.2" data-path="rprog3.html"><a href="rprog3.html#set-2-counting"><i class="fa fa-check"></i><b>6.6.2</b> Set 2: Counting</a></li>
<li class="chapter" data-level="6.6.3" data-path="rprog3.html"><a href="rprog3.html#set-3-weekly-tweets"><i class="fa fa-check"></i><b>6.6.3</b> Set 3: Weekly tweets</a></li>
<li class="chapter" data-level="6.6.4" data-path="rprog3.html"><a href="rprog3.html#are-tweets-correlated-in-time"><i class="fa fa-check"></i><b>6.6.4</b> Are tweets correlated in time?</a></li>
<li class="chapter" data-level="6.6.5" data-path="rprog3.html"><a href="rprog3.html#set-4-csu-vs.-cu"><i class="fa fa-check"></i><b>6.6.5</b> Set 4: CSU vs. CU</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="rprog3.html"><a href="rprog3.html#chapter-6-homework"><i class="fa fa-check"></i><b>6.7</b> Chapter 6 Homework</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="eda2.html"><a href="eda2.html"><i class="fa fa-check"></i><b>7</b> Multivariate Data Exploration</a>
<ul>
<li class="chapter" data-level="7.1" data-path="eda2.html"><a href="eda2.html#chapter-7-objectives"><i class="fa fa-check"></i><b>7.1</b> Chapter 7 Objectives</a></li>
<li class="chapter" data-level="7.2" data-path="eda2.html"><a href="eda2.html#bivariate"><i class="fa fa-check"></i><b>7.2</b> Bivariate Data</a></li>
<li class="chapter" data-level="7.3" data-path="eda2.html"><a href="eda2.html#scatt"><i class="fa fa-check"></i><b>7.3</b> Scatterplot</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="eda2.html"><a href="eda2.html#causality"><i class="fa fa-check"></i><b>7.3.1</b> Causality</a></li>
<li class="chapter" data-level="7.3.2" data-path="eda2.html"><a href="eda2.html#corr"><i class="fa fa-check"></i><b>7.3.2</b> Correlation</a></li>
<li class="chapter" data-level="7.3.3" data-path="eda2.html"><a href="eda2.html#correlation-neq-causation"><i class="fa fa-check"></i><b>7.3.3</b> Correlation <span class="math inline">\(\neq\)</span> causation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="eda2.html"><a href="eda2.html#exploring-multivariate-data"><i class="fa fa-check"></i><b>7.4</b> Exploring Multivariate Data</a>
<ul>
<li class="chapter" data-level="7.4.1" data-path="eda2.html"><a href="eda2.html#facets"><i class="fa fa-check"></i><b>7.4.1</b> Facets</a></li>
<li class="chapter" data-level="7.4.2" data-path="eda2.html"><a href="eda2.html#colors"><i class="fa fa-check"></i><b>7.4.2</b> Colors</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="eda2.html"><a href="eda2.html#chapter-7-exercises"><i class="fa fa-check"></i><b>7.5</b> Chapter 7 Exercises</a>
<ul>
<li class="chapter" data-level="7.5.1" data-path="eda2.html"><a href="eda2.html#fuel-economy-data"><i class="fa fa-check"></i><b>7.5.1</b> Fuel economy data</a></li>
<li class="chapter" data-level="7.5.2" data-path="eda2.html"><a href="eda2.html#import-and-wrangle-data"><i class="fa fa-check"></i><b>7.5.2</b> Import and wrangle data</a></li>
<li class="chapter" data-level="7.5.3" data-path="eda2.html"><a href="eda2.html#check-data"><i class="fa fa-check"></i><b>7.5.3</b> Check data</a></li>
<li class="chapter" data-level="7.5.4" data-path="eda2.html"><a href="eda2.html#check-for-missing-data"><i class="fa fa-check"></i><b>7.5.4</b> Check for missing data</a></li>
<li class="chapter" data-level="7.5.5" data-path="eda2.html"><a href="eda2.html#visualize-data"><i class="fa fa-check"></i><b>7.5.5</b> Visualize data</a></li>
<li class="chapter" data-level="7.5.6" data-path="eda2.html"><a href="eda2.html#multivariate-time-series"><i class="fa fa-check"></i><b>7.5.6</b> Multivariate time series</a></li>
<li class="chapter" data-level="7.5.7" data-path="eda2.html"><a href="eda2.html#density-plots"><i class="fa fa-check"></i><b>7.5.7</b> Density plots</a></li>
<li class="chapter" data-level="7.5.8" data-path="eda2.html"><a href="eda2.html#more-multivariate-plotting"><i class="fa fa-check"></i><b>7.5.8</b> More multivariate plotting</a></li>
<li class="chapter" data-level="7.5.9" data-path="eda2.html"><a href="eda2.html#practice-questions"><i class="fa fa-check"></i><b>7.5.9</b> Practice questions</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="eda2.html"><a href="eda2.html#chapter-7-homework"><i class="fa fa-check"></i><b>7.6</b> Chapter 7 Homework</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rprog4.html"><a href="rprog4.html"><i class="fa fa-check"></i><b>8</b> Functional Programming</a>
<ul>
<li class="chapter" data-level="8.1" data-path="rprog4.html"><a href="rprog4.html#ch.-8-objectives"><i class="fa fa-check"></i><b>8.1</b> Ch. 8 Objectives</a></li>
<li class="chapter" data-level="8.2" data-path="rprog4.html"><a href="rprog4.html#what-is-functional-programming"><i class="fa fa-check"></i><b>8.2</b> What is <strong><em>functional programming</em></strong>?</a></li>
<li class="chapter" data-level="8.3" data-path="rprog4.html"><a href="rprog4.html#writng-functions"><i class="fa fa-check"></i><b>8.3</b> Writng Functions</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="rprog4.html"><a href="rprog4.html#example-function-my_mean"><i class="fa fa-check"></i><b>8.3.1</b> Example Function: my_mean</a></li>
<li class="chapter" data-level="8.3.2" data-path="rprog4.html"><a href="rprog4.html#example-function-import.w.name"><i class="fa fa-check"></i><b>8.3.2</b> Example Function: “import.w.name”</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="rprog4.html"><a href="rprog4.html#the-purrr-package"><i class="fa fa-check"></i><b>8.4</b> The <code>purrr::</code> package</a>
<ul>
<li class="chapter" data-level="8.4.1" data-path="rprog4.html"><a href="rprog4.html#function-mapping"><i class="fa fa-check"></i><b>8.4.1</b> Function Mapping</a></li>
</ul></li>
<li class="chapter" data-level="8.5" data-path="rprog4.html"><a href="rprog4.html#homework"><i class="fa fa-check"></i><b>8.5</b> Homework</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="transform.html"><a href="transform.html"><i class="fa fa-check"></i><b>9</b> Transformations and Other Tricks</a>
<ul>
<li class="chapter" data-level="9.1" data-path="transform.html"><a href="transform.html#ch.-9-objectives"><i class="fa fa-check"></i><b>9.1</b> Ch. 9 Objectives</a></li>
<li class="chapter" data-level="9.2" data-path="transform.html"><a href="transform.html#transformation"><i class="fa fa-check"></i><b>9.2</b> Transformation</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="transform.html"><a href="transform.html#centering"><i class="fa fa-check"></i><b>9.2.1</b> Centering</a></li>
<li class="chapter" data-level="9.2.2" data-path="transform.html"><a href="transform.html#rescaling"><i class="fa fa-check"></i><b>9.2.2</b> Rescaling</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="transform.html"><a href="transform.html#normalization-and-standardization"><i class="fa fa-check"></i><b>9.3</b> Normalization and Standardization</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="transform.html"><a href="transform.html#rate-normalization"><i class="fa fa-check"></i><b>9.3.1</b> Rate normalization</a></li>
<li class="chapter" data-level="9.3.2" data-path="transform.html"><a href="transform.html#standardizing"><i class="fa fa-check"></i><b>9.3.2</b> Standardizing</a></li>
<li class="chapter" data-level="9.3.3" data-path="transform.html"><a href="transform.html#reducing-skewness"><i class="fa fa-check"></i><b>9.3.3</b> Reducing Skewness</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="transform.html"><a href="transform.html#stratification"><i class="fa fa-check"></i><b>9.4</b> Stratification</a></li>
<li class="chapter" data-level="9.5" data-path="transform.html"><a href="transform.html#outliers-and-censoring"><i class="fa fa-check"></i><b>9.5</b> Outliers and Censoring</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="transform.html"><a href="transform.html#outliers"><i class="fa fa-check"></i><b>9.5.1</b> Detecting Outliers</a></li>
<li class="chapter" data-level="9.5.2" data-path="transform.html"><a href="transform.html#censoring-outliers"><i class="fa fa-check"></i><b>9.5.2</b> Censoring outliers</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="transform.html"><a href="transform.html#ch-9-exercises"><i class="fa fa-check"></i><b>9.6</b> Ch-9 Exercises</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="transform.html"><a href="transform.html#salary-data-for-poly-sci-majors"><i class="fa fa-check"></i><b>9.6.1</b> Salary Data for Poly Sci Majors</a></li>
<li class="chapter" data-level="9.6.2" data-path="transform.html"><a href="transform.html#univariate-data-visualization-1"><i class="fa fa-check"></i><b>9.6.2</b> Univariate Data Visualization</a></li>
<li class="chapter" data-level="9.6.3" data-path="transform.html"><a href="transform.html#rescale-and-censor-data"><i class="fa fa-check"></i><b>9.6.3</b> Rescale and Censor Data</a></li>
<li class="chapter" data-level="9.6.4" data-path="transform.html"><a href="transform.html#logfit"><i class="fa fa-check"></i><b>9.6.4</b> Fit a Log-normal Distribution</a></li>
<li class="chapter" data-level="9.6.5" data-path="transform.html"><a href="transform.html#plot-fitted-vs-actual-data"><i class="fa fa-check"></i><b>9.6.5</b> Plot Fitted vs Actual Data</a></li>
<li class="chapter" data-level="9.6.6" data-path="transform.html"><a href="transform.html#transform-the-data"><i class="fa fa-check"></i><b>9.6.6</b> Transform the Data</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="transform.html"><a href="transform.html#ch-9-homework"><i class="fa fa-check"></i><b>9.7</b> Ch-9 Homework</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="measure.html"><a href="measure.html"><i class="fa fa-check"></i><b>10</b> Measurement</a>
<ul>
<li class="chapter" data-level="10.1" data-path="measure.html"><a href="measure.html#ch.-10-objectives"><i class="fa fa-check"></i><b>10.1</b> Ch. 10 Objectives</a></li>
<li class="chapter" data-level="10.2" data-path="measure.html"><a href="measure.html#sampling"><i class="fa fa-check"></i><b>10.2</b> Sampling</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="measure.html"><a href="measure.html#sample"><i class="fa fa-check"></i><b>10.2.1</b> Samples vs. Populations</a></li>
<li class="chapter" data-level="10.2.2" data-path="measure.html"><a href="measure.html#sample.collect"><i class="fa fa-check"></i><b>10.2.2</b> Collecting a sample</a></li>
<li class="chapter" data-level="10.2.3" data-path="measure.html"><a href="measure.html#simple-random-sampling"><i class="fa fa-check"></i><b>10.2.3</b> Simple Random Sampling</a></li>
<li class="chapter" data-level="10.2.4" data-path="measure.html"><a href="measure.html#systematic-sampling"><i class="fa fa-check"></i><b>10.2.4</b> Systematic Sampling</a></li>
<li class="chapter" data-level="10.2.5" data-path="measure.html"><a href="measure.html#stratified-sampling"><i class="fa fa-check"></i><b>10.2.5</b> Stratified Sampling</a></li>
<li class="chapter" data-level="10.2.6" data-path="measure.html"><a href="measure.html#cluster-sampling"><i class="fa fa-check"></i><b>10.2.6</b> Cluster Sampling</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="measure.html"><a href="measure.html#figures-of-merit"><i class="fa fa-check"></i><b>10.3</b> Figures of Merit</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="measure.html"><a href="measure.html#LOD"><i class="fa fa-check"></i><b>10.3.1</b> Limit of Detection &amp; Quantification</a></li>
<li class="chapter" data-level="10.3.2" data-path="measure.html"><a href="measure.html#dynamic"><i class="fa fa-check"></i><b>10.3.2</b> Dynamic Range</a></li>
<li class="chapter" data-level="10.3.3" data-path="measure.html"><a href="measure.html#precision"><i class="fa fa-check"></i><b>10.3.3</b> Precision</a></li>
<li class="chapter" data-level="10.3.4" data-path="measure.html"><a href="measure.html#bias"><i class="fa fa-check"></i><b>10.3.4</b> Bias (accuracy)</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="measure.html"><a href="measure.html#measurement-uncertainty"><i class="fa fa-check"></i><b>10.4</b> Measurement Uncertainty</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="measure.html"><a href="measure.html#repeated"><i class="fa fa-check"></i><b>10.4.1</b> Repeated Measures</a></li>
<li class="chapter" data-level="10.4.2" data-path="measure.html"><a href="measure.html#error-propagation"><i class="fa fa-check"></i><b>10.4.2</b> Error Propagation</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="measure.html"><a href="measure.html#ch-10-homework"><i class="fa fa-check"></i><b>10.5</b> CH-10 Homework</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model.html"><a href="model.html"><i class="fa fa-check"></i><b>11</b> Modeling</a>
<ul>
<li class="chapter" data-level="11.1" data-path="model.html"><a href="model.html#ch.-11-objectives"><i class="fa fa-check"></i><b>11.1</b> Ch. 11 Objectives</a></li>
<li class="chapter" data-level="11.2" data-path="model.html"><a href="model.html#process-modeling"><i class="fa fa-check"></i><b>11.2</b> Process Modeling</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="model.html"><a href="model.html#assumptions"><i class="fa fa-check"></i><b>11.2.1</b> Assumptions</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="model.html"><a href="model.html#model-fitting"><i class="fa fa-check"></i><b>11.3</b> Model Fitting</a></li>
<li class="chapter" data-level="11.4" data-path="model.html"><a href="model.html#ols-regression"><i class="fa fa-check"></i><b>11.4</b> OLS Regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="model.html"><a href="model.html#OLS_assum"><i class="fa fa-check"></i><b>11.4.1</b> OLS Assumptions and Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="model.html"><a href="model.html#example-ols-linear-regression"><i class="fa fa-check"></i><b>11.5</b> Example: OLS Linear Regression</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="model.html"><a href="model.html#the-lm-function"><i class="fa fa-check"></i><b>11.5.1</b> The <code>lm()</code> function</a></li>
<li class="chapter" data-level="11.5.2" data-path="model.html"><a href="model.html#ols-diagnostics"><i class="fa fa-check"></i><b>11.5.2</b> OLS Diagnostics</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="model.html"><a href="model.html#calibration"><i class="fa fa-check"></i><b>11.6</b> Calibration</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="model.html"><a href="model.html#example-calibration"><i class="fa fa-check"></i><b>11.6.1</b> Example Calibration</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="model.html"><a href="model.html#ch-11-homework"><i class="fa fa-check"></i><b>11.7</b> Ch-11 Homework</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="dist.html"><a href="dist.html"><i class="fa fa-check"></i><b>12</b> Appendix: Stats &amp; Reference Distributions</a>
<ul>
<li class="chapter" data-level="12.1" data-path="dist.html"><a href="dist.html#measures-of-central-tendency"><i class="fa fa-check"></i><b>12.1</b> Measures of Central Tendency</a></li>
<li class="chapter" data-level="12.2" data-path="dist.html"><a href="dist.html#measures-of-dispersion"><i class="fa fa-check"></i><b>12.2</b> Measures of Dispersion</a></li>
<li class="chapter" data-level="12.3" data-path="dist.html"><a href="dist.html#unif_dist"><i class="fa fa-check"></i><b>12.3</b> Uniform Distribution</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="dist.html"><a href="dist.html#uniform-characteristic-plots"><i class="fa fa-check"></i><b>12.3.1</b> Uniform Characteristic Plots</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="dist.html"><a href="dist.html#normal_dist"><i class="fa fa-check"></i><b>12.4</b> Normal Distribution</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="dist.html"><a href="dist.html#normal-characteristic-plots"><i class="fa fa-check"></i><b>12.4.1</b> Normal Characteristic Plots</a></li>
<li class="chapter" data-level="12.4.2" data-path="dist.html"><a href="dist.html#rule"><i class="fa fa-check"></i><b>12.4.2</b> 68-95-99 rule</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="dist.html"><a href="dist.html#log_normal_dist"><i class="fa fa-check"></i><b>12.5</b> Log-normal Distribution</a>
<ul>
<li class="chapter" data-level="12.5.1" data-path="dist.html"><a href="dist.html#lognormal-characteristic-plots"><i class="fa fa-check"></i><b>12.5.1</b> Lognormal Characteristic Plots</a></li>
</ul></li>
<li class="chapter" data-level="12.6" data-path="dist.html"><a href="dist.html#pearson"><i class="fa fa-check"></i><b>12.6</b> Pearson Correlation Coefficient</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="dist.html"><a href="dist.html#anscombes-quartet"><i class="fa fa-check"></i><b>12.6.1</b> Anscombe’s Quartet</a></li>
</ul></li>
<li class="chapter" data-level="12.7" data-path="dist.html"><a href="dist.html#OLS"><i class="fa fa-check"></i><b>12.7</b> OLS Regression Coefficients</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Engineering Data Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rprog3" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> Strings, Dates, and Tidying<a href="rprog3.html#rprog3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="chapter-6-objectives" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Chapter 6 Objectives<a href="rprog3.html#chapter-6-objectives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>This Chapter is designed around the following learning objectives. Upon
completing this Chapter, you should be able to:</p>
<ul>
<li>Define the meaning of “strings” and “date time” objects in R</li>
<li>Manipulate character strings using the <code>stringr</code> and <code>tidyr</code> packages of functions</li>
<li>Parse strings using regular expressions (“regex”)</li>
<li>Describe how R stores a POSIXct date and time object internally</li>
<li>Convert a character vector to a date format using functions from the
<code>lubridate</code> R package</li>
<li>Extract information from a date object (e.g., month, year, day of week) using <code>lubridate</code> functions</li>
<li>Search, organize, and visualize data that are linked to date objects</li>
<li>Apply functions from the <code>dplyr</code> and <code>tidyr</code> packages to make dataframes “tidy”</li>
</ul>
</div>
<div id="strings" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Strings<a href="rprog3.html#strings" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong><em>Strings</em></strong> are a form of character data like “John”, or “blue”, or “John’s
sample 8021A turned blue”.</p>
<p><strong>Strings are defined in R using quotes <code>" "</code></strong> and stored as <code>character</code>
vectors; they often show up in data analysis in one of two ways:</p>
<ol style="list-style-type: decimal">
<li><p>As <strong><em>metadata</em></strong>. Metadata means: “data that describe other data”.<br />
A <em>readme.txt</em> file is metadata; notes and code comments are metadata. All of
these types of data usually come in the form of strings and are included
<strong>with the data your are analyzing</strong> but not <strong>in the dataset</strong> itself.</p></li>
<li><p>As <strong><em>vectorized data</em></strong>. In R programming, <em>“vectorized”</em> means: stored
as a column of data. Examples of vectorized strings that you might find
include things like: “participant names”, or “survey responses to question 1”,
or “mode of failure”. The example below creates three different string vectors
in R. <em>Note:</em> You can check the type of object you’ve created using the
<code>class()</code> or <code>typeof()</code> functions.</p></li>
</ol>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="rprog3.html#cb190-1" tabindex="-1"></a><span class="co"># examples of vectorized string data</span></span>
<span id="cb190-2"><a href="rprog3.html#cb190-2" tabindex="-1"></a>names_respond <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Ahmed&quot;</span>, </span>
<span id="cb190-3"><a href="rprog3.html#cb190-3" tabindex="-1"></a>                   <span class="st">&quot;Josh&quot;</span>, </span>
<span id="cb190-4"><a href="rprog3.html#cb190-4" tabindex="-1"></a>                   <span class="st">&quot;Mateo&quot;</span>, </span>
<span id="cb190-5"><a href="rprog3.html#cb190-5" tabindex="-1"></a>                   <span class="st">&quot;William&quot;</span>, </span>
<span id="cb190-6"><a href="rprog3.html#cb190-6" tabindex="-1"></a>                   <span class="st">&quot;Ali&quot;</span>, </span>
<span id="cb190-7"><a href="rprog3.html#cb190-7" tabindex="-1"></a>                   <span class="st">&quot;Wei&quot;</span>, </span>
<span id="cb190-8"><a href="rprog3.html#cb190-8" tabindex="-1"></a>                   <span class="st">&quot;Steve-O&quot;</span>,</span>
<span id="cb190-9"><a href="rprog3.html#cb190-9" tabindex="-1"></a>                   <span class="st">&quot;John&quot;</span>)</span>
<span id="cb190-10"><a href="rprog3.html#cb190-10" tabindex="-1"></a>q1_responses <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Because you told me to do it.&quot;</span>,</span>
<span id="cb190-11"><a href="rprog3.html#cb190-11" tabindex="-1"></a>                  <span class="st">&quot;It seemed like the right thing to do at the time.&quot;</span>,</span>
<span id="cb190-12"><a href="rprog3.html#cb190-12" tabindex="-1"></a>                  <span class="st">&quot;Because I had been over-served.&quot;</span>,</span>
<span id="cb190-13"><a href="rprog3.html#cb190-13" tabindex="-1"></a>                  <span class="st">&quot;I don&#39;t know. I just did it.&quot;</span>,</span>
<span id="cb190-14"><a href="rprog3.html#cb190-14" tabindex="-1"></a>                  <span class="st">&quot;I got caught up in the heat of the moment.&quot;</span>,</span>
<span id="cb190-15"><a href="rprog3.html#cb190-15" tabindex="-1"></a>                  <span class="st">&quot;I was given an opportunity. I took my shot.&quot;</span>,</span>
<span id="cb190-16"><a href="rprog3.html#cb190-16" tabindex="-1"></a>                  <span class="st">&quot;I plead the 5th.&quot;</span>,</span>
<span id="cb190-17"><a href="rprog3.html#cb190-17" tabindex="-1"></a>                  <span class="st">&quot;I could ask you the same question.&quot;</span>)</span>
<span id="cb190-18"><a href="rprog3.html#cb190-18" tabindex="-1"></a>failure_mode <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;fracture&quot;</span>,</span>
<span id="cb190-19"><a href="rprog3.html#cb190-19" tabindex="-1"></a>                  <span class="st">&quot;yielding&quot;</span>, </span>
<span id="cb190-20"><a href="rprog3.html#cb190-20" tabindex="-1"></a>                  <span class="st">&quot;deflection&quot;</span>, </span>
<span id="cb190-21"><a href="rprog3.html#cb190-21" tabindex="-1"></a>                  <span class="st">&quot;fatigue&quot;</span>, </span>
<span id="cb190-22"><a href="rprog3.html#cb190-22" tabindex="-1"></a>                  <span class="st">&quot;creep&quot;</span>)</span>
<span id="cb190-23"><a href="rprog3.html#cb190-23" tabindex="-1"></a></span>
<span id="cb190-24"><a href="rprog3.html#cb190-24" tabindex="-1"></a><span class="co"># proof of vector type</span></span>
<span id="cb190-25"><a href="rprog3.html#cb190-25" tabindex="-1"></a><span class="fu">class</span>(names_respond)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<p>The first step in analyzing a string is to parse it.
<strong>To parse means to examine the individual components.</strong> For example, when you
read this sentence you parse the words and then assign meaning to those
words based on your memory, your understanding of grammar, and the context in
which those words occur. Context is often critical to understanding because the
meaning of words can change from one context to the next (i.e., whether you are
reading an instruction manual, a text message, a novel, or a warrant for your
arrest). Strings can be challenging to analyze because computers are built on
logical operations and mathematics; strings are neither of those. Computers
have fantastic memory, are OK at grammar, and are comically poor at
contextualization. Taken together, this means that strings can be challenging
(but not impossible) to analyze using computers.</p>
<div class="rmdnote">
<p>
Are you active on social media platforms like Instagram or Twitter?
You can bet that a computer program has downloaded and parsed all of
your posts, each one as a string. You can learn a lot about a person
(and their buying habits) from what they post online!
</p>
</div>
<p>In this chapter, we will introduce a few simple string functions from base R
and the <code>stringr</code> package. We will also introduce the concept of
<strong>regular expressions</strong> as a means to perform more advanced string
manipulation.</p>
<p><img src="images/parse_comic.png" width="1000" style="display: block; margin: auto;" /></p>
<div id="string-detect-match-subset" class="section level3 hasAnchor" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> String detect, match, subset<a href="rprog3.html#string-detect-match-subset" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of the simplest string operations is to search whether a string contains a
pattern of interest. The <code>stringr</code> package (part of the
<a href="https://stringr.tidyverse.org/" target="_blank">Tidyverse</a>) was developed
to simplify the
analysis of strings. Most of the functions in <code>stringr</code> begin with <code>str_</code> and
end with a specific function name. A full list of functions is provided
<a href="https://stringr.tidyverse.org/reference/index.html" target="_blank">here</a>. Some examples:</p>
<ol style="list-style-type: decimal">
<li><strong><code>str_detect()</code></strong> returns a vector of logical values (TRUE/FALSE) indicating whether the pattern was detected within each string searched. The function takes two arguments, the <code>string</code> to be searched and the <code>pattern</code> for which to search. Let’s search for the pattern <code>"Josh"</code> in the character vector of strings, <code>names_respond</code>, that we created above:</li>
</ol>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="rprog3.html#cb192-1" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="at">string =</span> names_respond, </span>
<span id="cb192-2"><a href="rprog3.html#cb192-2" tabindex="-1"></a>                    <span class="at">pattern =</span> <span class="st">&quot;Josh&quot;</span>)</span></code></pre></div>
<pre><code>## [1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>As expected, only one string in the vector produced a match.</p>
<p>An added benefit of logical functions like <code>str_detect()</code> is that return values
of <code>TRUE</code> are coded as 1 and <code>FALSE</code> as 0. Thus, if we <code>sum()</code> the result of
the <code>str_detect()</code> search, we will get the cumulative number of matches to
<code>"Josh"</code> from within our data.</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb194-1"><a href="rprog3.html#cb194-1" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="at">string =</span> names_respond, </span>
<span id="cb194-2"><a href="rprog3.html#cb194-2" tabindex="-1"></a>           <span class="at">pattern =</span> <span class="st">&quot;Josh&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb194-3"><a href="rprog3.html#cb194-3" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>In other words, logical functions like <code>str_detect()</code> allow us to do math on
string data! For example, we can now calculate the proportion of <code>"Josh"</code>
entries within our sample:</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="rprog3.html#cb196-1" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_detect</span>(<span class="at">string =</span> names_respond, </span>
<span id="cb196-2"><a href="rprog3.html#cb196-2" tabindex="-1"></a>                    <span class="at">pattern =</span> <span class="st">&quot;Josh&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb196-3"><a href="rprog3.html#cb196-3" tabindex="-1"></a>  <span class="fu">sum</span>() <span class="sc">/</span> <span class="fu">length</span>(names_respond)</span></code></pre></div>
<pre><code>## [1] 0.125</code></pre>
<ol start="2" style="list-style-type: decimal">
<li><strong><code>str_extract()</code></strong> takes the same arguments as <code>str_detect()</code> but returns a vector of the matched values (by string index). By “matched values”, I mean only the portion of the string for which the search created a match.</li>
</ol>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="rprog3.html#cb198-1" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_extract</span>(<span class="at">string =</span> names_respond, </span>
<span id="cb198-2"><a href="rprog3.html#cb198-2" tabindex="-1"></a>                     <span class="at">pattern =</span> <span class="st">&quot;Jo&quot;</span>)</span></code></pre></div>
<pre><code>## [1] NA   &quot;Jo&quot; NA   NA   NA   NA   NA   &quot;Jo&quot;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li><strong><code>str_subset()</code></strong> returns only the entries that were matched (i.e., if a match was detected, then the entire string that was matched is returned). If we subset our short list of names to the pattern of letters <code>"li"</code>, we get:</li>
</ol>
<div class="sourceCode" id="cb200"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb200-1"><a href="rprog3.html#cb200-1" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_subset</span>(<span class="at">string =</span> names_respond, </span>
<span id="cb200-2"><a href="rprog3.html#cb200-2" tabindex="-1"></a>           <span class="at">pattern =</span> <span class="st">&quot;li&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;William&quot; &quot;Ali&quot;</code></pre>
<p>To note, there are base R versions of all these <code>stringr</code> functions. Most are
performed with the <code>grep</code> family of functions. The term <em>“grep”</em> is an acronym
for <strong><u>G</u>lobal <u>R</u>egular <u>E</u>xpression <u>P</u>attern</strong> (more on
<em>regular expressions</em> below). Many “old-school” coders use this family of
functions, therefore, you will encounter them in the wild, so it’s worth
knowing about them.</p>
<table>
<thead>
<tr>
<th style="text-align:left;">
stringr_funcs
</th>
<th style="text-align:left;">
base_funcs
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
str_detect(x, pattern)
</td>
<td style="text-align:left;">
grepl(pattern, x)
</td>
</tr>
<tr>
<td style="text-align:left;">
str_match(x, pattern)
</td>
<td style="text-align:left;">
regexec(pattern, x) + regmatches()
</td>
</tr>
<tr>
<td style="text-align:left;">
str_subset(x, pattern)
</td>
<td style="text-align:left;">
grep(pattern, x, value = TRUE)
</td>
</tr>
</tbody>
</table>
</div>
<div id="regular-expressions" class="section level3 hasAnchor" number="6.2.2">
<h3><span class="header-section-number">6.2.2</span> Regular Expressions<a href="rprog3.html#regular-expressions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Before going much farther, we should spend some time discussing
<strong><em>regular expressions</em></strong> or <strong>regex</strong> for short. When we pass a <code>pattern</code>
argument to a function like <code>str_detect()</code>, the function treats that argument
like a “regex”. Up until this point, I have only passed simple character
strings as <code>pattern</code> arguments (i.e., <code>pattern = "Josh"</code>). In reality, we can
create much more advanced search criteria using <strong>regex</strong> syntax within our
search patterns.</p>
<div class="rmdnote">
<p>
A <strong>regular expression</strong> is a sequence of characters
that define a search pattern to be implemented on a string.
</p>
</div>
<p>In the R programming language, regular expressions follow the POSIX 1003.2
standard; regex can have different syntax based on the underlying standard.
Regex are created by including search syntax (i.e., symbols that communicate
search parameters) within your quoted string. For example, square brackets <code>[]</code>
in a search pattern indicate a search for <em>any</em> of the characters within the
brackets; conversely, to match <em>all</em> the characters you simply include them in
quotes. A key strength of regex patterns is that they allow you to use logical
and conditional relations. For example, the following text search patterns can
be coded as regex:</p>
<table>
<colgroup>
<col width="65%" />
<col width="34%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Desired Search Pattern</th>
<th align="left">Regex in R</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><em>any letter followed by the numbers 3, 4, or 5</em></td>
<td align="left">“[:alpha:][345]”</td>
</tr>
<tr class="even">
<td align="left"><em>strings that start with ‘ID’ and are followed by 4 numbers</em></td>
<td align="left">“^ID[:digit:]{4}”</td>
</tr>
</tbody>
</table>
<p>One challenging aspect of string searching in R, however, is that certain
“special characters” like the quote <code>"</code> and the backslash <code>\</code> symbol must be
explicitly identified within the string in order to be interpreted by R
correctly. To identify these <em>special characters</em> in a string, you need to
<strong><em>“escape”</em></strong> that character using a backslash <code>\</code>. Thus, if you want to
search for a quote symbol, you would type in <code>\"</code>. Whenever a regex requires
the use of a <code>\</code>, you have to identify it within a string as <code>\\</code>. The table
below shows some basic regex syntax and how they would be implemented as a
search pattern in R.</p>
<table>
<caption>
<span id="tab:regex-1">Table 6.1: </span>Basic Regex Search Syntax and Example Implementation in R
</caption>
<thead>
<tr>
<th style="text-align:center;">
Regex syntax
</th>
<th style="text-align:center;">
String to be matched
</th>
<th style="text-align:center;">
Example in R
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center;">
\d
</td>
<td style="text-align:center;">
Any numeric digit
</td>
<td style="text-align:center;">
"\\d" or "[:digit:]"
</td>
</tr>
<tr>
<td style="text-align:center;">
[abc]
</td>
<td style="text-align:center;">
matches a, b, or c
</td>
<td style="text-align:center;">
"[abc]"
</td>
</tr>
<tr>
<td style="text-align:center;">
[a-z]
</td>
<td style="text-align:center;">
matches every character between a and z
</td>
<td style="text-align:center;">
"[a-z]"
</td>
</tr>
<tr>
<td style="text-align:center;">
[^abc]
</td>
<td style="text-align:center;">
matches anything except a, b, or c
</td>
<td style="text-align:center;">
"[^abc]"
</td>
</tr>
<tr>
<td style="text-align:center;">
(abc)
</td>
<td style="text-align:center;">
creates a "capture group" whereby abc must occur together
</td>
<td style="text-align:center;">
"(abc)"
</td>
</tr>
<tr>
<td style="text-align:center;">
^b
</td>
<td style="text-align:center;">
starts with: look for "b" at the start of a string
</td>
<td style="text-align:center;">
"^b"
</td>
</tr>
<tr>
<td style="text-align:center;">
b$
</td>
<td style="text-align:center;">
ends with: look for "b" at the end of a string
</td>
<td style="text-align:center;">
"b$"
</td>
</tr>
<tr>
<td style="text-align:center;">
a|b
</td>
<td style="text-align:center;">
match a or b
</td>
<td style="text-align:center;">
"a|b"
</td>
</tr>
</tbody>
</table>
<p><strong>Regex</strong> sequences have seemingly no end of sophistication and nuance; you
could spend dozens of hours learning to use them and hundreds more learning to
master them. We will only introduce basic concepts here. More in-depth
introductions to regex syntax and usage can be found on <a href="http://r4ds.had.co.nz/strings.html" target="_blank">Hadley Wickham’s R course</a>,
on the <code>stringr</code>
<a href="https://github.com/rstudio/cheatsheets/raw/master/strings.pdf" target="_blank">cheatsheet</a>
developed by RStudio, and through practice with, my personal favorite, a game
of <a href="https://alf.nu/RegexGolf" target="_blank">Regex Golf</a>.</p>
</div>
<div id="string-split-replace" class="section level3 hasAnchor" number="6.2.3">
<h3><span class="header-section-number">6.2.3</span> String split, replace<a href="rprog3.html#string-split-replace" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>str_split()</code> will split a string into two (or more) pieces when a match is
detected. The string will always be split at the first match and again at each
additional match location, unless you specify that only a finite number of <code>n</code>
matches should occur. A couple points to note:</p>
<ul>
<li><p><code>str_split()</code> splits on each side of the match; the matched part of the string
is <em>not</em> included in the output.</p></li>
<li><p>because both sides of the split string are returned, your output will take
the form of a <code>list</code>.</p></li>
</ul>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="rprog3.html#cb202-1" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_split</span>(<span class="at">string =</span> names_respond, <span class="at">pattern =</span> <span class="st">&quot;t&quot;</span>)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;Ahmed&quot;
## 
## [[2]]
## [1] &quot;Josh&quot;
## 
## [[3]]
## [1] &quot;Ma&quot; &quot;eo&quot;
## 
## [[4]]
## [1] &quot;William&quot;
## 
## [[5]]
## [1] &quot;Ali&quot;
## 
## [[6]]
## [1] &quot;Wei&quot;
## 
## [[7]]
## [1] &quot;S&quot;     &quot;eve-O&quot;
## 
## [[8]]
## [1] &quot;John&quot;</code></pre>
<p><code>str_replace()</code> searches for a match and then replaces the matched value
with a new string of your choosing. The function takes three arguments: the
<code>string</code> to be searched, the <code>pattern</code> to match, and the <code>replacement</code>
string to be inserted. Let’s replace the first period detected in each of
the <code>q1_responses</code> strings with a question mark. Both <code>.</code> and <code>?</code> are
<em>special characters</em> so we need to <em>“escape”</em> each of these symbols with two
back-slashes <code>\\</code>.</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="rprog3.html#cb204-1" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_replace</span>(<span class="at">string =</span> q1_responses,</span>
<span id="cb204-2"><a href="rprog3.html#cb204-2" tabindex="-1"></a>                     <span class="at">pattern =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">.&quot;</span>,</span>
<span id="cb204-3"><a href="rprog3.html#cb204-3" tabindex="-1"></a>                     <span class="at">replacement =</span> <span class="st">&quot;</span><span class="sc">\\</span><span class="st">?&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Because you told me to do it?&quot;                    
## [2] &quot;It seemed like the right thing to do at the time?&quot;
## [3] &quot;Because I had been over-served?&quot;                  
## [4] &quot;I don&#39;t know? I just did it.&quot;                     
## [5] &quot;I got caught up in the heat of the moment?&quot;       
## [6] &quot;I was given an opportunity? I took my shot.&quot;      
## [7] &quot;I plead the 5th?&quot;                                 
## [8] &quot;I could ask you the same question?&quot;</code></pre>
<p>The <code>str_replace()</code> family of functions is useful for cleaning up misspellings
(or other unwanted language) in strings. Note, however, that <code>str_replace()</code>
will normally replace only one instance of a match; use <code>str_replace_all()</code> if
you plan to encounter multiple matches that need replacing.</p>
<div class="rmdtip">
<p>
The <code>pattern =</code> argument for matching can be a single
string or a vector of strings. In the latter case, you can define a
vector of <em>keywords</em> that you might be searching for across
sentences. In that case, use
<code>pattern = c(“pattern_1”, “pattern_2”, “pattern_3”, …etc)</code>.
</p>
</div>
</div>
</div>
<div id="dates-and-date-times" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Dates and Date-times<a href="rprog3.html#dates-and-date-times" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Working with dates and times can be challenging. This section begins with a
discussion of how base R handles dates and times, since there is a ton of code
out there that utilizes these older functions. We will then quickly transition
to the <code>lubridate</code> family of functions (part of the Tidyverse) because of their
versatility and ease-of-use.</p>
<div id="dates-and-times-in-base-r" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Dates and Times in base R<a href="rprog3.html#dates-and-times-in-base-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Dates and times in base R all proceed from an <em>“epoch”</em> or <em>time origin</em>. In
R, the <em>epoch</em> or “dawn of time” occurred at midnight on January 1<sup>st</sup>, 1970.
For the sake of the R programming world, the concept of time started at that
precise moment and has moved forward ever since. To note: R can handle
date-times before 1/1/1970; it just treats them as negative values!</p>
<p>To see a date-time object, you can tell R to give you the current “System Time”
by calling the <code>Sys.time()</code> function.</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="rprog3.html#cb206-1" tabindex="-1"></a><span class="fu">Sys.time</span>()</span></code></pre></div>
<pre><code>## [1] &quot;2023-08-15 10:58:00 MDT&quot;</code></pre>
<p>As you can see, we got back the date, time, and timezone used by my computer
(<em>whenever I last ran this code in <code>bookdown</code></em>). If you want to see how this
time is stored in R internally, you can use <code>unclass()</code>, which returns an
object value with its class attributes removed. When we wrap <code>unclass()</code>
around <code>Sys.time()</code>, we will see the number of seconds that have occurred
between the epoch of 1/1/1970 and right now:</p>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="rprog3.html#cb208-1" tabindex="-1"></a><span class="fu">unclass</span>(<span class="fu">Sys.time</span>())</span></code></pre></div>
<pre><code>## [1] 1692118681</code></pre>
<p>That’s a lot of seconds. How many years is that?<br />
Just divide that number by [60s/min <span class="math inline">\(\cdot\)</span> 60min/hr <span class="math inline">\(\cdot\)</span> 24hr/d <span class="math inline">\(\cdot\)</span>
365d/yr] =&gt; 53.6567314 years.</p>
<p>This calculation ignores leap years, but you get the point…</p>
</div>
<div id="date-time-formats" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Date-time formats<a href="rprog3.html#date-time-formats" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Note that the <code>Sys.time()</code> function provided the date in a
<strong><em>“year-month-day”</em></strong> format and the time in an <strong><em>“hour-minute-second”</em></strong>
format: 2023-08-15 10:58:00.848803.</p>
<p>Not everyone uses this exact ordering when they record dates and times, which
is one of the reasons working with dates and times can be tricky. You probably
have little difficulty recognizing the following date-time objects as
equivalent but, for some computer programs, not so much:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:date-times-1">Table 6.2: </span>Date-time objects come in different forms
</caption>
<tbody>
<tr>
<td style="text-align:left;">
12/1/99 8:46 PM
</td>
</tr>
<tr>
<td style="text-align:left;">
1-Dec-1999 20:46 UTC
</td>
</tr>
<tr>
<td style="text-align:left;">
December 1st, 1999, 20:46:00
</td>
</tr>
</tbody>
</table>
<div class="rmdnote">
<p>
You will often see time followed by <strong>“UTC”</strong>, which
stands for <em>“Universal Time, Coordinated”</em>. UTC is preferred by
programmers because it doesn’t have a timezone and it doesn’t follow
<em>Daylight Savings Time</em> conventions. Daylight savings is the bane
of many coders.
</p>
<p>
In practice, UTC is the same time as GMT (Greenwich Mean Time,
pronounced “gren-itch”) but with an important distinction. GMT is one of
the many <a
href="https://wikipedia.org/wiki/List_of_tz_database_time_zones"
target="_blank">time-zones</a> laid out across Earth’s longitude,
whereas, <strong>UTC has no timezone</strong>; UTC is the same time for
everyone, everywhere.
</p>
<p>
In Colorado, we are UTC-6 hours during <em>daylight savings</em>
(March-Nov) and UTC-7 during <em>standard time</em> (Nov-March). This
means that most Coloradoans eat dinner at 12am UTC (6pm MST).
</p>
</div>
</div>
<div id="date-time-classes-in-r" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Date-time classes in R<a href="rprog3.html#date-time-classes-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>R has several classes of date-time objects, none of which are easy to remember:</p>
<ol style="list-style-type: decimal">
<li><strong><code>POSIXct</code></strong> - stored as the time, in seconds, between the <code>epoch</code> of 1970-01-01 00:00:00 UTC and the date-time object in question.
<ul>
<li>the ‘ct’ stands for <em>“continuous time”</em> to represent “continuous seconds from origin”;</li>
<li>A <code>POSIXct</code> object is a single numeric vector, thus useful for efficient computing.</li>
</ul></li>
<li><strong><code>POSIXlt</code></strong> - stored as a list of date-time objects.
<ul>
<li>the ‘lt’ stands for <em>“list time”</em>.</li>
<li>A <code>POSIXlt</code> list contains the following elements:
<ul>
<li><em>sec</em> as 0–61 seconds</li>
<li><em>min</em> as 0–59 minutes</li>
<li><em>hour</em> as 0–23 hours</li>
<li><em>mday</em> as 1–31 day of the month</li>
<li><em>mon</em> as 0–11 months after the first of the year</li>
<li><em>year</em> as Years since 1900</li>
<li><em>wday</em> as 0–6 day of the week, starting on Sunday</li>
<li><em>yday</em> as 0–365 days of the year.</li>
<li><em>isdst</em> as a flag for Daylight savings time. Positive if in force, zero if not, negative if unknown.</li>
</ul></li>
</ul></li>
<li><strong><code>POSIXt</code></strong> - this is a virtual class. <code>POSIXt</code> (without the “l”) is an internal way for R to convert between <code>POSIXct</code> and <code>POSIXlt</code> date-time objects.
<ul>
<li>Think of the <code>POSIXt</code> as a way for R to perform operations/conversions between a <code>POSIXct</code> and <code>POSIXlt</code> object without throwing an error your way.</li>
</ul></li>
</ol>
<p>As a reminder, here are some common <strong>object classes</strong> in R:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Class
</th>
<th style="text-align:left;">
Example
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>character</code>
</td>
<td style="text-align:left;">
“Chemistry”, “Physics”, “Mathematics”
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>numeric</code>
</td>
<td style="text-align:left;">
10, 20, 30, 40
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>factor</code>
</td>
<td style="text-align:left;">
Male [underlying number: 1], Female [2]
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>Date</code>
</td>
<td style="text-align:left;">
“2010-01-01” [underlying number: 14,610]
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>logical</code>
</td>
<td style="text-align:left;">
TRUE, FALSE
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>date-time</code>
</td>
<td style="text-align:left;">
“2020-06-23 11:05:20 MDT”
</td>
</tr>
</tbody>
</table>
<p>To discover the class of a vector (including a column in a dataframe—remember
each column can be thought of as a vector), you can use <code>class()</code>:</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="rprog3.html#cb210-1" tabindex="-1"></a><span class="fu">class</span>(<span class="fu">Sys.time</span>())</span></code></pre></div>
<pre><code>## [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</code></pre>
<p>Both the <code>POSIXct</code> and <code>POSIXlt</code> class of objects return the same value to the
user; the difference is really in how these classes store date-time objects
internally. To examine them, you can coerce <code>Sys.time()</code> into each of the two
classes using <code>as.POSIXct</code> and <code>as.POSIXlt</code> functions and then examine their
attributes.</p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="rprog3.html#cb212-1" tabindex="-1"></a>time_now_ct <span class="ot">&lt;-</span> <span class="fu">as.POSIXct</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb212-2"><a href="rprog3.html#cb212-2" tabindex="-1"></a><span class="fu">unclass</span>(time_now_ct)</span></code></pre></div>
<pre><code>## [1] 1692118681</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="rprog3.html#cb214-1" tabindex="-1"></a>time_now_lt <span class="ot">&lt;-</span> <span class="fu">as.POSIXlt</span>(<span class="fu">Sys.time</span>())</span>
<span id="cb214-2"><a href="rprog3.html#cb214-2" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">unclass</span>(time_now_lt)) <span class="co"># the `str()` function makes the output more compact</span></span></code></pre></div>
<pre><code>## List of 11
##  $ sec   : num 0.897
##  $ min   : int 58
##  $ hour  : int 10
##  $ mday  : int 15
##  $ mon   : int 7
##  $ year  : int 123
##  $ wday  : int 2
##  $ yday  : int 226
##  $ isdst : int 1
##  $ zone  : chr &quot;MDT&quot;
##  $ gmtoff: int -21600
##  - attr(*, &quot;tzone&quot;)= chr [1:3] &quot;&quot; &quot;MST&quot; &quot;MDT&quot;
##  - attr(*, &quot;balanced&quot;)= logi TRUE</code></pre>
<p>It’s easy to see why the <code>POSIXct</code> object class is more computationally
efficient, but it’s also nice to see all the date-time information packed into
the <code>POSIXlt</code>. This is why R keeps a key to unlock both using <code>POSIXt</code>.<br />
As my father used to say: clear as mud?</p>
</div>
<div id="reading-and-classifying-date-times" class="section level3 hasAnchor" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Reading and classifying date-times<a href="rprog3.html#reading-and-classifying-date-times" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Oftentimes, when data is read into R, there are column elements that contain
date and time information. These dates and times are often interpreted by R
as <em>character</em> vectors, which means they have lost their relational attributes
For example, you cannot subtract “Monday 08:00” from “Wednesday 12:00” and get
“2 days 4 hours”. If we want to analyze dates and times in a relational way,
we need to instruct R to recognize these as date-time objects (i.e., as either
the <code>POSIXct</code> or <code>POSIXlt</code> class). Thus, to convert a character vector into
date or date-time object requires a change of that vector’s class.</p>
<p>Date-time elements can be tricky to work with for a few reasons:</p>
<ol style="list-style-type: decimal">
<li>Different programs store and handle dates and times in different ways<br />
</li>
<li>The existence of time zones means that date-time values can change with location</li>
<li>Date-time strings can be separated with spaces, colons, commas, slashes, dashes, or a mix of all those together (see Table <a href="rprog3.html#tab:date-times-1">6.2</a>)</li>
</ol>
<p>The base R function to convert between <code>character</code> classes and <code>date-time</code>
classes is the function <code>strptime()</code>, which is short for
<em>“<strong>str</strong>ing <strong>p</strong>arse into date-<strong>time</strong>”</em>. I mention this function not because
I encourage you to use it but because I want you to be able to recognize it. The
function has over 39 conversion specifications that it can take as arguments.
That is to say, this function not simple to master. If you are a glutton for
punishment, I invite you to read the R Documentation with <code>?strptime</code>.</p>
<p>Here are a few base R functions for working with date-time objects that are
worth knowing:</p>
<table class="table table-striped" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:base-r-times">Table 6.3: </span>Basic Date-time functions
</caption>
<thead>
<tr>
<th style="text-align:left;">
{base} R Function
</th>
<th style="text-align:left;">
Value Returned
</th>
<th style="text-align:left;">
Example
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Sys.Date()
</td>
<td style="text-align:left;">
Current system date
</td>
<td style="text-align:left;">
“2020-06-23”
</td>
</tr>
<tr>
<td style="text-align:left;">
Sys.time()
</td>
<td style="text-align:left;">
Current system date-Time
</td>
<td style="text-align:left;">
“2020-06-23 11:05:20 MDT”
</td>
</tr>
<tr>
<td style="text-align:left;">
Sys.timezone()
</td>
<td style="text-align:left;">
Current system timezone
</td>
<td style="text-align:left;">
“America/Denver”
</td>
</tr>
<tr>
<td style="text-align:left;">
as.POSIXct()
</td>
<td style="text-align:left;">
date-time object of class POSIXct
</td>
<td style="text-align:left;">
“2020-06-23 11:05:20 MDT”
</td>
</tr>
<tr>
<td style="text-align:left;">
as.POSIXlt()
</td>
<td style="text-align:left;">
date-time object of class POSIXlt
</td>
<td style="text-align:left;">
“2020-06-23 11:05:20 MDT”
</td>
</tr>
<tr>
<td style="text-align:left;">
strptime()
</td>
<td style="text-align:left;">
date-time object of class POSIXlt
</td>
<td style="text-align:left;">
“2020-06-23 11:05:20 MDT”
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="lubridate" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> <code>lubridate</code><a href="rprog3.html#lubridate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>lubridate</code> package was developed specifically to make it easier to work
with date-time objects. You can find out more information on <code>lubridate</code>
<a href="https://lubridate.tidyverse.org/" target="_blank">here</a>.</p>
<div id="parsing-functions-in-lubridate" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Parsing functions in <code>lubridate</code><a href="rprog3.html#parsing-functions-in-lubridate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>One of best aspects of <code>lubridate</code> is its ability to parse date-time objects
with simplicity and ease; the <code>lubridate</code> parsing functions are designed as
“named-to-order”. Let me explain:</p>
<blockquote>
<p><span style="color: blue;"> <strong>Parse</strong>: <strong><em>to break apart and analyze the individual components</em></strong> of something, like a character string. </span></p>
</blockquote>
<ul>
<li><p>If a character vector is written in “<strong>y</strong>ear-<strong>m</strong>onth-<strong>d</strong>ay” format (e.g., <code>"2020-Dec-18"</code>), then the <code>lubridate</code> function to convert that vector is <code>ymd()</code>.</p></li>
<li><p>If a character vector is written in “<strong>d</strong>ay-<strong>m</strong>onth-<strong>y</strong>ear” format (e.g., <code>"18-Dec-2020"</code>), then the <code>lubridate</code> function to convert that vector is <code>dmy()</code>. Try it out:</p></li>
</ul>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="rprog3.html#cb216-1" tabindex="-1"></a><span class="co"># create a character vector</span></span>
<span id="cb216-2"><a href="rprog3.html#cb216-2" tabindex="-1"></a>date_old <span class="ot">&lt;-</span> <span class="st">&quot;2020-Dec-18&quot;</span></span>
<span id="cb216-3"><a href="rprog3.html#cb216-3" tabindex="-1"></a></span>
<span id="cb216-4"><a href="rprog3.html#cb216-4" tabindex="-1"></a><span class="co"># prove it&#39;s a character class</span></span>
<span id="cb216-5"><a href="rprog3.html#cb216-5" tabindex="-1"></a><span class="fu">class</span>(date_old)</span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="rprog3.html#cb218-1" tabindex="-1"></a><span class="co"># convert it to a `Date` class with `ymd()`</span></span>
<span id="cb218-2"><a href="rprog3.html#cb218-2" tabindex="-1"></a>date_new <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">ymd</span>(date_old)</span>
<span id="cb218-3"><a href="rprog3.html#cb218-3" tabindex="-1"></a></span>
<span id="cb218-4"><a href="rprog3.html#cb218-4" tabindex="-1"></a><span class="co"># prove it worked</span></span>
<span id="cb218-5"><a href="rprog3.html#cb218-5" tabindex="-1"></a><span class="fu">class</span>(date_new)</span></code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<p>That little conversion exercise may not have blown you away, but watch what
happens when I feed the following set of wacky character vectors into that
same <code>lubridate</code> parsing function, <code>ymd()</code>:</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="rprog3.html#cb220-1" tabindex="-1"></a>messy_dates <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;2020------Dec the 12&quot;</span>,</span>
<span id="cb220-2"><a href="rprog3.html#cb220-2" tabindex="-1"></a>                 <span class="st">&quot;20.-.12.-.12&quot;</span>,</span>
<span id="cb220-3"><a href="rprog3.html#cb220-3" tabindex="-1"></a>                 <span class="st">&quot;2020aaa12aaa12&quot;</span>,</span>
<span id="cb220-4"><a href="rprog3.html#cb220-4" tabindex="-1"></a>                 <span class="st">&quot;20,12,12&quot;</span>,</span>
<span id="cb220-5"><a href="rprog3.html#cb220-5" tabindex="-1"></a>                 <span class="st">&quot;2020x12-12&quot;</span>,</span>
<span id="cb220-6"><a href="rprog3.html#cb220-6" tabindex="-1"></a>                 <span class="st">&quot;2020   ....    12        ......     12&quot;</span>,</span>
<span id="cb220-7"><a href="rprog3.html#cb220-7" tabindex="-1"></a>                 <span class="st">&quot;&#39;20.December-12&quot;</span>)</span>
<span id="cb220-8"><a href="rprog3.html#cb220-8" tabindex="-1"></a><span class="fu">ymd</span>(messy_dates)</span></code></pre></div>
<pre><code>## [1] &quot;2020-12-12&quot; &quot;2020-12-12&quot; &quot;2020-12-12&quot; &quot;2020-12-12&quot; &quot;2020-12-12&quot;
## [6] &quot;2020-12-12&quot; &quot;2020-12-12&quot;</code></pre>
<p>Boom. That’s right, the <code>ymd()</code> parsing function figured them all out correctly
with almost no effort on your part. But wait, there’s more!</p>
<p>The <code>lubridate</code> package contains parsing functions for almost any order you can
imagine.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Parsing Function
</th>
<th style="text-align:left;">
Format to Convert
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>ymd()</code>
</td>
<td style="text-align:left;">
year-month-day
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>mdy()</code>
</td>
<td style="text-align:left;">
month-day-year
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>dmy()</code>
</td>
<td style="text-align:left;">
day-month-year
</td>
</tr>
</tbody>
</table>
<p>And if you need to parse a time component, simply add a combination of <code>_hms</code> to
the function call to parse time in “hours-minutes-seconds” format. Some
additional examples of how you would parse time that followed from a <code>ymd</code>
format:</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Parsing Function
</th>
<th style="text-align:left;">
Format to Convert
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>ymd_h()</code>
</td>
<td style="text-align:left;">
year-month-day_hours
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>mdy_hm()</code>
</td>
<td style="text-align:left;">
year-month-day_hours-minutes
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>dmy_hms()</code>
</td>
<td style="text-align:left;">
year-month-day_hours-minutes-seconds
</td>
</tr>
</tbody>
</table>
<p>The beauty of the <code>lubridate</code> parsers is that they do the hard work of cleaning
up the character vector, regardless of separators or delimiters within each
string, and return either a <code>Date</code> or <code>Date-time</code> object class.</p>
</div>
<div id="date-time-manipulation-with-lubridate" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Date-time manipulation with <code>lubridate</code><a href="rprog3.html#date-time-manipulation-with-lubridate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To convert the <code>date</code> column in the <code>daily_show</code> data into a Date class, you can
run:</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="rprog3.html#cb222-1" tabindex="-1"></a><span class="fu">library</span>(<span class="at">package =</span> <span class="st">&quot;lubridate&quot;</span>)</span>
<span id="cb222-2"><a href="rprog3.html#cb222-2" tabindex="-1"></a></span>
<span id="cb222-3"><a href="rprog3.html#cb222-3" tabindex="-1"></a><span class="co"># check the class of the &#39;date&#39; column before mutating it</span></span>
<span id="cb222-4"><a href="rprog3.html#cb222-4" tabindex="-1"></a><span class="fu">class</span>(<span class="at">x =</span> daily_show<span class="sc">$</span>date) </span></code></pre></div>
<pre><code>## [1] &quot;character&quot;</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="rprog3.html#cb224-1" tabindex="-1"></a>daily_show <span class="ot">&lt;-</span> <span class="fu">mutate</span>(<span class="at">.data =</span> daily_show,</span>
<span id="cb224-2"><a href="rprog3.html#cb224-2" tabindex="-1"></a>                     <span class="at">date =</span> <span class="fu">mdy</span>(date))</span>
<span id="cb224-3"><a href="rprog3.html#cb224-3" tabindex="-1"></a><span class="fu">head</span>(<span class="at">x =</span> daily_show, <span class="at">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##    year job                date       category guest_name     
##   &lt;dbl&gt; &lt;chr&gt;              &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;          
## 1  1999 actor              1999-01-11 Acting   Michael J. Fox 
## 2  1999 Comedian           1999-01-12 Comedy   Sandra Bernhard
## 3  1999 television actress 1999-01-13 Acting   Tracey Ullman</code></pre>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="rprog3.html#cb226-1" tabindex="-1"></a><span class="co"># check the class of the &#39;date&#39; column after mutating it</span></span>
<span id="cb226-2"><a href="rprog3.html#cb226-2" tabindex="-1"></a><span class="fu">class</span>(<span class="at">x =</span> daily_show<span class="sc">$</span>date) </span></code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<p>Once you have an object in the <code>Date</code> class, you can do things like plot by
date, calculate the range of dates, and calculate the total number of days the
dataset covers:</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="rprog3.html#cb228-1" tabindex="-1"></a><span class="co"># report the min and max dates</span></span>
<span id="cb228-2"><a href="rprog3.html#cb228-2" tabindex="-1"></a><span class="fu">range</span>(daily_show<span class="sc">$</span>date)</span>
<span id="cb228-3"><a href="rprog3.html#cb228-3" tabindex="-1"></a></span>
<span id="cb228-4"><a href="rprog3.html#cb228-4" tabindex="-1"></a><span class="co"># calculate the duration from first to last date using base</span></span>
<span id="cb228-5"><a href="rprog3.html#cb228-5" tabindex="-1"></a><span class="fu">max</span>(daily_show<span class="sc">$</span>date) <span class="sc">-</span> <span class="fu">min</span>(daily_show<span class="sc">$</span>date)</span></code></pre></div>
<p>We could have used these to transform the date in <code>daily_show</code>, using the
following pipe chain:</p>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="rprog3.html#cb229-1" tabindex="-1"></a>daily_show <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="at">file =</span> <span class="st">&quot;data/daily_show_guests.csv&quot;</span>,</span>
<span id="cb229-2"><a href="rprog3.html#cb229-2" tabindex="-1"></a>                              <span class="at">skip =</span> <span class="dv">4</span>) <span class="sc">%&gt;%</span></span>
<span id="cb229-3"><a href="rprog3.html#cb229-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">job =</span> GoogleKnowlege_Occupation,</span>
<span id="cb229-4"><a href="rprog3.html#cb229-4" tabindex="-1"></a>                <span class="at">date =</span> Show,</span>
<span id="cb229-5"><a href="rprog3.html#cb229-5" tabindex="-1"></a>                <span class="at">category =</span> Group,</span>
<span id="cb229-6"><a href="rprog3.html#cb229-6" tabindex="-1"></a>                <span class="at">guest_name =</span> Raw_Guest_List) <span class="sc">%&gt;%</span></span>
<span id="cb229-7"><a href="rprog3.html#cb229-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>YEAR) <span class="sc">%&gt;%</span></span>
<span id="cb229-8"><a href="rprog3.html#cb229-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">date =</span> lubridate<span class="sc">::</span><span class="fu">mdy</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb229-9"><a href="rprog3.html#cb229-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(category <span class="sc">==</span> <span class="st">&quot;Science&quot;</span>)</span>
<span id="cb229-10"><a href="rprog3.html#cb229-10" tabindex="-1"></a></span>
<span id="cb229-11"><a href="rprog3.html#cb229-11" tabindex="-1"></a><span class="co"># show first two rows of dataframe</span></span>
<span id="cb229-12"><a href="rprog3.html#cb229-12" tabindex="-1"></a><span class="fu">head</span>(<span class="at">x =</span> daily_show, <span class="at">n =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   job          date       category guest_name     
##   &lt;chr&gt;        &lt;date&gt;     &lt;chr&gt;    &lt;chr&gt;          
## 1 neurosurgeon 2003-04-28 Science  Dr Sanjay Gupta
## 2 scientist    2004-01-13 Science  Catherine Weitz</code></pre>
<p>The <code>lubridate</code> package also includes functions to pull out certain elements of
a date, including:</p>
<ul>
<li><code>wday()</code> return the day of the week pertaining to a Date object</li>
<li><code>mday()</code> return the day of the month pertaining to a Date object</li>
<li><code>yday()</code> return the day of the year pertaining to a Date object</li>
<li><code>month()</code> return the month pertaining to a Date object</li>
<li><code>quarter()</code> return the quarter of hte year pertaining to a Date object</li>
<li><code>year()</code> return the year pertaining to a date object</li>
</ul>
<p>For example, we could use <code>wday()</code> to create a new column with the weekday of
each show:</p>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="rprog3.html#cb231-1" tabindex="-1"></a>daily_show <span class="sc">%&gt;%</span> </span>
<span id="cb231-2"><a href="rprog3.html#cb231-2" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">show_day =</span> lubridate<span class="sc">::</span><span class="fu">wday</span>(<span class="at">x =</span> date,</span>
<span id="cb231-3"><a href="rprog3.html#cb231-3" tabindex="-1"></a>                                           <span class="at">label =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb231-4"><a href="rprog3.html#cb231-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(date, show_day, guest_name) <span class="sc">%&gt;%</span></span>
<span id="cb231-5"><a href="rprog3.html#cb231-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>## # A tibble: 5 × 3
##   date       show_day guest_name            
##   &lt;date&gt;     &lt;ord&gt;    &lt;chr&gt;                 
## 1 2003-04-28 Mon      Dr Sanjay Gupta       
## 2 2004-01-13 Tue      Catherine Weitz       
## 3 2004-06-15 Tue      Hassan Ibrahim        
## 4 2005-09-06 Tue      Dr. Marc Siegel       
## 5 2006-02-13 Mon      Astronaut Mike Mullane</code></pre>
<div class="rmdwarning">
<p>
R functions tend to use the timezone of <strong>YOUR</strong>
computer’s operating system by default—or UTC, or GMT. You need to be
careful when working with dates and times to either specify the time
zone or convince yourself the default behavior works for your
application.
</p>
</div>
</div>
</div>
<div id="tidy-data" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Tidy Data<a href="rprog3.html#tidy-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong><em>“Tidy Data”</em></strong> is a philosophy for how to arrange your data in a intuitive,
rectangular fashion, commonly in a <code>dataframe</code>. In his
<a href="https://www.jstatsoft.org/index.php/jss/article/view/v059i10/v59i10.pdf" target="_blank">2014 paper</a>,
Hadley Wickham states,
<em>“tidy datasets provide a standardized way to link the structure of a dataset (its physical layout) with its semantics (its meaning).”</em></p>
<p>The definition of a tidy dataset is straightforward:</p>
<ol style="list-style-type: decimal">
<li>Each variable forms a column.</li>
<li>Each observation forms a row.</li>
<li>Each type of observational unit forms a table.</li>
</ol>
<p>The first two rules, <em>each variable forms a column</em> and
<em>each observation forms a row</em>, are relatively easy to implement.
In fact, most of the dataframes that we have used so far follow this convention.
The trick is to note that some column variables might look <em>independent</em> from
one another, when, in fact, the columns represent a single variable broken out
by some hierarchical, or nesting, structure.</p>
<p>For example, the (untidy) table below (<a href="rprog3.html#tab:grades-untidy">6.4</a>) shows exam
grades for three students. Table <a href="rprog3.html#tab:grades-untidy">6.4</a> is untidy because
the variable depicting the exam score shows up in three different columns.<br />
Another way to characterize the <em>untidiness</em> of this table is that we have three
different exams (Exam1, Exam2, Exam3) that represent a variable (Exam_# or
Exam_type), that is not represented with a column.</p>
<table class="table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:grades-untidy">Table 6.4: </span>An Untidy Table of Exam Scores.
</caption>
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:right;">
Exam1_Score
</th>
<th style="text-align:right;">
Exam2_Score
</th>
<th style="text-align:right;">
Exam3_Score
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Harry
</td>
<td style="text-align:right;">
85
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
88
</td>
</tr>
<tr>
<td style="text-align:left;">
Ron
</td>
<td style="text-align:right;">
81
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
89
</td>
</tr>
<tr>
<td style="text-align:left;">
Hermione
</td>
<td style="text-align:right;">
95
</td>
<td style="text-align:right;">
97
</td>
<td style="text-align:right;">
99
</td>
</tr>
</tbody>
</table>
<p>Thus, to tidy table <a href="rprog3.html#tab:grades-untidy">6.4</a>, we need to create a variable
called <code>Exam</code> and move all the scores into a new column vector named <code>Scores</code>.
This effectively makes the data “long” rather than “wide”.</p>
<table class="table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:grades-tidy">Table 6.5: </span>A Tidy Table of Exam Scores
</caption>
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:right;">
Exam
</th>
<th style="text-align:right;">
Scores
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Harry
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
85
</td>
</tr>
<tr>
<td style="text-align:left;">
Harry
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
81
</td>
</tr>
<tr>
<td style="text-align:left;">
Harry
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
95
</td>
</tr>
<tr>
<td style="text-align:left;">
Ron
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
79
</td>
</tr>
<tr>
<td style="text-align:left;">
Ron
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
75
</td>
</tr>
<tr>
<td style="text-align:left;">
Ron
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
97
</td>
</tr>
<tr>
<td style="text-align:left;">
Hermione
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
88
</td>
</tr>
<tr>
<td style="text-align:left;">
Hermione
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
89
</td>
</tr>
<tr>
<td style="text-align:left;">
Hermione
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
99
</td>
</tr>
</tbody>
</table>
<p>For our work, one of the goals of data cleaning is to create datasets that
follow this <em>tidy</em> convention. Fortunately, the <code>tidyr</code> package contains a
useful function called <code>pivot_longer()</code> for re-arranging dataframes from
untidy (typically “wide) to tidy (”long”).</p>
<p><code>pivot_longer()</code> is designed to “lengthen” a data frame by
<em>“increasing the number of rows and decreasing the number of columns”</em>.
This function creates two new columns as output and requires four arguments:</p>
<ul>
<li><code>data =</code> the dataframe to be lengthened</li>
<li><code>cols =</code> a list of the columns that should be combined together (forming a
single variable to be represented in a new, single column)</li>
<li><code>names_to</code> = this is an output column that contains the <strong>names</strong> of the
old columns that are being combined.</li>
<li><code>values_to</code> = this is the other output column that contains the <strong>values</strong>
from within the old columns that are being combined.</li>
</ul>
<div class="rmdnote">
<p>
The <code>pivot_longer()</code> function always creates two new
columns:
</p>
<ul>
<li>
one column contains <code>names_to =</code> information.
</li>
<li>
the other column contains the <code>values_to =</code> data.
</li>
</ul>
</div>
<p>In the case of Table <a href="rprog3.html#tab:grades-untidy">6.4</a>, we are using <code>cols =</code> to combine
<code>Exam1_Score</code>, <code>Exam2_Score</code> and <code>Exam3_Score</code> into a a column of
<code>names_to = "Exam"</code> and the data represented in those three columns gets moved
into a column of <code>values_to = "Scores"</code>. We also add a call to <code>dplyr::mutate()</code>
and <code>dplyr::case_when()</code> to convert strings to numbers.</p>
<p>The <code>case_when()</code> function allows you introduce multiple “if/else” statements into
a vectorized operation, such as within this call to <code>dplyr:mutate()</code>. This function
takes a series of logical arguments as <em>cases</em>, with each case seeking to find a “match”. Once a “match” occurs, an outcome instruction is followed. In the code
chunk below, the left-hand-side of each “case” evaluates whether each entry in
the <code>Exam</code> column equates to a particular string (like <code>"Exam_1_Score"</code>). On the
right-hand-side of each case, separated by a <em>tilde</em> ~, contains the <code>mutate()</code>
instruction. In plain speak, the function reads:</p>
<blockquote>
<p>If the vector contains a string that matches “Exam_1_Score”, then replace that entry with a 1; else, if the vector contains a string that matches “Exam_2_Score”,
then replace that entry with a 2; else, if the vector contains a string that matches “Exam_3_Score”, then replace that entry with a 3.</p>
</blockquote>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="rprog3.html#cb233-1" tabindex="-1"></a>grades_untidy <span class="ot">&lt;-</span> tibble<span class="sc">::</span><span class="fu">tibble</span>(</span>
<span id="cb233-2"><a href="rprog3.html#cb233-2" tabindex="-1"></a>  <span class="at">Name =</span> <span class="fu">c</span>(<span class="st">&quot;Harry&quot;</span>, <span class="st">&quot;Ron&quot;</span>, <span class="st">&quot;Hermione&quot;</span>),</span>
<span id="cb233-3"><a href="rprog3.html#cb233-3" tabindex="-1"></a>  <span class="at">Exam1_Score =</span> <span class="fu">c</span>(<span class="dv">85</span>, <span class="dv">81</span>, <span class="dv">95</span>),</span>
<span id="cb233-4"><a href="rprog3.html#cb233-4" tabindex="-1"></a>  <span class="at">Exam2_Score =</span> <span class="fu">c</span>(<span class="dv">79</span>, <span class="dv">75</span>, <span class="dv">97</span>),</span>
<span id="cb233-5"><a href="rprog3.html#cb233-5" tabindex="-1"></a>  <span class="at">Exam3_Score =</span> <span class="fu">c</span>(<span class="dv">88</span>, <span class="dv">89</span>, <span class="dv">99</span>)</span>
<span id="cb233-6"><a href="rprog3.html#cb233-6" tabindex="-1"></a>  ) </span>
<span id="cb233-7"><a href="rprog3.html#cb233-7" tabindex="-1"></a></span>
<span id="cb233-8"><a href="rprog3.html#cb233-8" tabindex="-1"></a>tidygrades <span class="ot">&lt;-</span> tidyr<span class="sc">::</span><span class="fu">pivot_longer</span>(<span class="at">data =</span> grades_untidy,</span>
<span id="cb233-9"><a href="rprog3.html#cb233-9" tabindex="-1"></a>                                  <span class="at">cols =</span> Exam1_Score<span class="sc">:</span>Exam3_Score,</span>
<span id="cb233-10"><a href="rprog3.html#cb233-10" tabindex="-1"></a>                                  <span class="at">names_to =</span> <span class="st">&quot;Exam&quot;</span>,</span>
<span id="cb233-11"><a href="rprog3.html#cb233-11" tabindex="-1"></a>                                  <span class="at">values_to =</span> <span class="st">&quot;Scores&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb233-12"><a href="rprog3.html#cb233-12" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Exam =</span> dplyr<span class="sc">::</span><span class="fu">case_when</span>(</span>
<span id="cb233-13"><a href="rprog3.html#cb233-13" tabindex="-1"></a>    Exam <span class="sc">==</span> <span class="st">&quot;Exam1_Score&quot;</span> <span class="sc">~</span> <span class="dv">1</span>,</span>
<span id="cb233-14"><a href="rprog3.html#cb233-14" tabindex="-1"></a>    Exam <span class="sc">==</span> <span class="st">&quot;Exam2_Score&quot;</span> <span class="sc">~</span> <span class="dv">2</span>,</span>
<span id="cb233-15"><a href="rprog3.html#cb233-15" tabindex="-1"></a>    Exam <span class="sc">==</span> <span class="st">&quot;Exam3_Score&quot;</span> <span class="sc">~</span> <span class="dv">3</span></span>
<span id="cb233-16"><a href="rprog3.html#cb233-16" tabindex="-1"></a>  ))</span></code></pre></div>
<table class="table table-condensed" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:grades-tab3">Table 6.6: </span>Pivot longer applied to untidy data
</caption>
<thead>
<tr>
<th style="text-align:left;">
Name
</th>
<th style="text-align:right;">
Exam
</th>
<th style="text-align:right;">
Scores
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Harry
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
85
</td>
</tr>
<tr>
<td style="text-align:left;">
Harry
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
79
</td>
</tr>
<tr>
<td style="text-align:left;">
Harry
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
88
</td>
</tr>
<tr>
<td style="text-align:left;">
Ron
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
81
</td>
</tr>
<tr>
<td style="text-align:left;">
Ron
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
75
</td>
</tr>
<tr>
<td style="text-align:left;">
Ron
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
89
</td>
</tr>
<tr>
<td style="text-align:left;">
Hermione
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
95
</td>
</tr>
<tr>
<td style="text-align:left;">
Hermione
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
97
</td>
</tr>
<tr>
<td style="text-align:left;">
Hermione
</td>
<td style="text-align:right;">
3
</td>
<td style="text-align:right;">
99
</td>
</tr>
</tbody>
</table>
<p>Now these data are tidy, wherein each variable forms a column, each row
forms an observation, and the table is specific to one observational unit.
This may seem obvious, but most data analysis problems occur because of poor
data management techniques. Remember: What might seem useful at the time—like
a color-coded Excel spreadsheet—is a pain for computers and not reproducible.
Do yourself a favor and begin with the end in mind: <em>tidy data</em>.</p>
</div>
<div id="chapter-6-exercises" class="section level2 hasAnchor" number="6.6">
<h2><span class="header-section-number">6.6</span> Chapter 6 Exercises<a href="rprog3.html#chapter-6-exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The following exercises use data on tweets from United Senators, processed by
<a href="https://github.com/fivethirtyeight/data/tree/master/twitter-ratio" target="_blank">FiveThirtyEight</a>.</p>
<div id="set-1-data-import-and-manipulation" class="section level3 hasAnchor" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Set 1: Data import and manipulation<a href="rprog3.html#set-1-data-import-and-manipulation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a pipeline that</p>
<ul>
<li>imports the raw data (.csv) containing tweets from all US senators,</li>
<li>filters the raw data to only Colorado (“CO”) senators,</li>
<li>creates <strong>4 new variables</strong> within a call to the appropriate <code>dplyr</code> function and four distinct <code>lubridate</code> functions based on the format of the date or date-time variable:
<ul>
<li><code>date</code> from <code>created_at</code></li>
<li><code>hour_co</code> from <code>date</code>, also setting “America/Denver” timezone with <code>lubridate::with_tzone()</code></li>
<li><code>month</code> from <code>date</code></li>
<li><code>week</code> from <code>date</code>, and</li>
</ul></li>
<li>retains all variables <strong>except</strong> <code>url</code>, <code>created_at</code>, and <code>bioguide_id</code></li>
</ul>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="rprog3.html#cb234-1" tabindex="-1"></a><span class="co"># pipeline to import, filter, manipulate datetime vars, select vars </span></span>
<span id="cb234-2"><a href="rprog3.html#cb234-2" tabindex="-1"></a>tweets_co <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">&quot;data/senators.csv&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb234-3"><a href="rprog3.html#cb234-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(state <span class="sc">==</span> <span class="st">&quot;CO&quot;</span>) <span class="sc">%&gt;%</span> <span class="co"># filter to Colorado senators</span></span>
<span id="cb234-4"><a href="rprog3.html#cb234-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">date =</span> lubridate<span class="sc">::</span><span class="fu">mdy_hm</span>(created_at), <span class="co"># convert timestamp to datetime object</span></span>
<span id="cb234-5"><a href="rprog3.html#cb234-5" tabindex="-1"></a>         <span class="at">hour_co =</span> lubridate<span class="sc">::</span><span class="fu">hour</span>(lubridate<span class="sc">::</span><span class="fu">with_tz</span>(date, <span class="co"># convert timestamp to datetime object </span></span>
<span id="cb234-6"><a href="rprog3.html#cb234-6" tabindex="-1"></a>                                                      <span class="at">tzone =</span> <span class="st">&quot;America/Denver&quot;</span>)), <span class="co"># and add timezone label</span></span>
<span id="cb234-7"><a href="rprog3.html#cb234-7" tabindex="-1"></a>         <span class="at">month =</span> lubridate<span class="sc">::</span><span class="fu">month</span>(date), <span class="co"># create var of month from timestamp</span></span>
<span id="cb234-8"><a href="rprog3.html#cb234-8" tabindex="-1"></a>         <span class="at">week =</span> lubridate<span class="sc">::</span><span class="fu">week</span>(date)) <span class="sc">%&gt;%</span> <span class="co"># create var of week from timestamp</span></span>
<span id="cb234-9"><a href="rprog3.html#cb234-9" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>(<span class="fu">c</span>(url, created_at, bioguide_id))) <span class="co"># retain all vars except 3</span></span></code></pre></div>
</div>
<div id="set-2-counting" class="section level3 hasAnchor" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Set 2: Counting<a href="rprog3.html#set-2-counting" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>Which Colorado senators are included in the data?</li>
</ol>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="rprog3.html#cb235-1" tabindex="-1"></a><span class="co"># find unique strings within user variable</span></span>
<span id="cb235-2"><a href="rprog3.html#cb235-2" tabindex="-1"></a><span class="co"># if you convert to factor, you can also find `levels()`</span></span>
<span id="cb235-3"><a href="rprog3.html#cb235-3" tabindex="-1"></a><span class="fu">unique</span>(tweets_co<span class="sc">$</span>user) </span></code></pre></div>
<pre><code>## [1] &quot;SenBennetCO&quot;    &quot;SenCoryGardner&quot;</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Which Colorado Senator tweets the most?</li>
</ol>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="rprog3.html#cb237-1" tabindex="-1"></a><span class="co"># compare number of tweets by senator; remember to always ungroup grouped data!</span></span>
<span id="cb237-2"><a href="rprog3.html#cb237-2" tabindex="-1"></a>tweets_co <span class="sc">%&gt;%</span> </span>
<span id="cb237-3"><a href="rprog3.html#cb237-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(user) <span class="sc">%&gt;%</span> </span>
<span id="cb237-4"><a href="rprog3.html#cb237-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb237-5"><a href="rprog3.html#cb237-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   user               n
##   &lt;chr&gt;          &lt;int&gt;
## 1 SenBennetCO     2211
## 2 SenCoryGardner  3225</code></pre>
</div>
<div id="set-3-weekly-tweets" class="section level3 hasAnchor" number="6.6.3">
<h3><span class="header-section-number">6.6.3</span> Set 3: Weekly tweets<a href="rprog3.html#set-3-weekly-tweets" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Create a time series plot that indicates tweet activity on a weekly basis since
2011 for the Colorado senators. You will need to first create a new data frame
that contains new time-date variables based on the (a) total time and (b) weeks
since data collection started.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="rprog3.html#cb239-1" tabindex="-1"></a><span class="co"># create new time-based variables</span></span>
<span id="cb239-2"><a href="rprog3.html#cb239-2" tabindex="-1"></a>tweets_co_wk <span class="ot">&lt;-</span> tweets_co <span class="sc">%&gt;%</span> </span>
<span id="cb239-3"><a href="rprog3.html#cb239-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">time_since =</span> <span class="fu">as.duration</span>(date <span class="sc">-</span> <span class="fu">min</span>(date)), <span class="co"># create duration variable, time since first datum</span></span>
<span id="cb239-4"><a href="rprog3.html#cb239-4" tabindex="-1"></a>         <span class="at">week =</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(time_since, <span class="st">&quot;weeks&quot;</span>), <span class="dv">0</span>)) <span class="sc">%&gt;%</span> <span class="co"># duration rounded to nearest cumulative &quot;weeks&quot;</span></span>
<span id="cb239-5"><a href="rprog3.html#cb239-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(user, week) <span class="sc">%&gt;%</span> <span class="co"># by week per user</span></span>
<span id="cb239-6"><a href="rprog3.html#cb239-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tally</span>() <span class="sc">%&gt;%</span> <span class="co"># tweet count </span></span>
<span id="cb239-7"><a href="rprog3.html#cb239-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="co"># remember to ungroup grouped data</span></span></code></pre></div>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="rprog3.html#cb240-1" tabindex="-1"></a><span class="co"># plot time series of tweets per week per senator since 2011</span></span>
<span id="cb240-2"><a href="rprog3.html#cb240-2" tabindex="-1"></a>ggplot2<span class="sc">::</span><span class="fu">ggplot</span>(<span class="at">data =</span> tweets_co_wk, </span>
<span id="cb240-3"><a href="rprog3.html#cb240-3" tabindex="-1"></a>       <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> week, <span class="at">y =</span> n, <span class="at">color =</span> user)) <span class="sc">+</span></span>
<span id="cb240-4"><a href="rprog3.html#cb240-4" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb240-5"><a href="rprog3.html#cb240-5" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb240-6"><a href="rprog3.html#cb240-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Number of tweets per week by Colorado senator since 2011&quot;</span>,</span>
<span id="cb240-7"><a href="rprog3.html#cb240-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Gardner joined Twitter later but tweets more (and cyclically)&quot;</span>)</span></code></pre></div>
<p><img src="06-string_date_files/figure-html/tweet-time-series-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="are-tweets-correlated-in-time" class="section level3 hasAnchor" number="6.6.4">
<h3><span class="header-section-number">6.6.4</span> Are tweets correlated in time?<a href="rprog3.html#are-tweets-correlated-in-time" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We arbitrarily selected “weekly number of tweets” by each senator and it’s possible that tweet volume in a prior week correlate with tweet volume in a subsequent week (i.e., autocorrelation). This calls for an autocorrelation plot! We’ll create one for Senator Gardner.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="rprog3.html#cb241-1" tabindex="-1"></a><span class="co"># create a data frame with only Gardner&#39;s tweets</span></span>
<span id="cb241-2"><a href="rprog3.html#cb241-2" tabindex="-1"></a>tweets_gardner <span class="ot">&lt;-</span> tweets_co_wk <span class="sc">%&gt;%</span></span>
<span id="cb241-3"><a href="rprog3.html#cb241-3" tabindex="-1"></a>  <span class="fu">filter</span>(user <span class="sc">==</span> <span class="st">&quot;SenCoryGardner&quot;</span>)</span>
<span id="cb241-4"><a href="rprog3.html#cb241-4" tabindex="-1"></a></span>
<span id="cb241-5"><a href="rprog3.html#cb241-5" tabindex="-1"></a><span class="co"># create a partial autocorrelation plot of tweets by week</span></span>
<span id="cb241-6"><a href="rprog3.html#cb241-6" tabindex="-1"></a><span class="fu">pacf</span>(tweets_gardner<span class="sc">$</span>n, <span class="at">lag.max =</span> <span class="dv">60</span>)  <span class="co">#go out more than 52 weeks to see annual correlation</span></span></code></pre></div>
<p><img src="06-string_date_files/figure-html/tweet-pacf-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>It appears, as one might expect, that tweets are correlated in time. Most of the correlation happens in the first three lags, so maybe these data would be better suited for a monthly average…</p>
</div>
<div id="set-4-csu-vs.-cu" class="section level3 hasAnchor" number="6.6.5">
<h3><span class="header-section-number">6.6.5</span> Set 4: CSU vs. CU<a href="rprog3.html#set-4-csu-vs.-cu" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ol style="list-style-type: decimal">
<li>How many times are strings related to CSU mentioned by each senator by year?
This might include things like “CSU”, “colostate”, “Colostate”, “Colorado State
U”, “Rams”, etc. You will need to use a few <code>dplyr</code> functions, one <code>lubridate</code>
function, and one <code>stringr</code> function within the pipeline.</li>
</ol>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="rprog3.html#cb242-1" tabindex="-1"></a><span class="co"># determine number of csu-related tweets by senator per year</span></span>
<span id="cb242-2"><a href="rprog3.html#cb242-2" tabindex="-1"></a>tweets_co <span class="sc">%&gt;%</span></span>
<span id="cb242-3"><a href="rprog3.html#cb242-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(user, lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb242-4"><a href="rprog3.html#cb242-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(text, <span class="st">&quot;CSU|colostate|Colostate|Colorado State U|RAMS|Rams|csu&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb242-5"><a href="rprog3.html#cb242-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb242-6"><a href="rprog3.html#cb242-6" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    user           `lubridate::year(date)`     n
##    &lt;chr&gt;                            &lt;dbl&gt; &lt;int&gt;
##  1 SenBennetCO                       2011     1
##  2 SenBennetCO                       2012     1
##  3 SenBennetCO                       2013     1
##  4 SenBennetCO                       2014     2
##  5 SenBennetCO                       2015     2
##  6 SenBennetCO                       2017     1
##  7 SenCoryGardner                    2013     4
##  8 SenCoryGardner                    2015     5
##  9 SenCoryGardner                    2016     2
## 10 SenCoryGardner                    2017     2</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>What is the content of the tweets extracted in the previous question? You
will need to use another <code>stringr</code> function. You can use the same text strings
as before.</li>
</ol>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="rprog3.html#cb244-1" tabindex="-1"></a><span class="co"># extract csu-related tweet content</span></span>
<span id="cb244-2"><a href="rprog3.html#cb244-2" tabindex="-1"></a>stringr<span class="sc">::</span><span class="fu">str_subset</span>(tweets_co<span class="sc">$</span>text, </span>
<span id="cb244-3"><a href="rprog3.html#cb244-3" tabindex="-1"></a>                    <span class="st">&quot;CSU|colostate|Colostate|Colorado State U|RAMS|Rams|csu&quot;</span>)</span></code></pre></div>
<pre><code>##  [1] &quot;RT @CSUAgSci: .@SenBennetCO &amp;amp; @SenCoryGardner announce $500K @usda grant to @ColoradoStateU to study Farm to School program https://t.co/kb��_&quot;
##  [2] &quot;Best of luck to @CSUMensBball in #NIT first round against South Dakota State! #GoRams&quot;                                                             
##  [3] &quot;CSU-led study shows risks for CO if we don&#39;t tackle climate change. Risks worsen the longer we wait. It&#39;s time to act http://t.co/Nlz4pmj8D6&quot;      
##  [4] &quot;Congrats to @CSUPFootball on tonight&#39;s #NCAAD2 championship win! Great game and even better season. #BackthePack&quot;                                  
##  [5] &quot;Just wrapped up day 1 of our #COinnovation tour w/ visit to @CSUenergy engines lab. Day 2 in #GrandJunction tomorrow. http://t.co/2Yt5c09Tn3&quot;      
##  [6] &quot;Here&#39;s my #MarchMadness bracket. How do your picks compare? We&#39;ll be rooting for you @CUBuffsMBB and @CSUMensBball! https://t.co/4DCdvryOjb&quot;       
##  [7] &quot;Good luck to @CSUMensBball against Murray State this morning. #MarchMadness #CSUNCAA&quot;                                                              
##  [8] &quot;Good luck @cubuffs, @CSUFootball and @UNCOFOOTBALL this season. #gobuffs #Rams #BearNation&quot;                                                        
##  [9] &quot;RT @NewsCPR: .@SenCoryGardner on @CSUPoliSci&#39;s John Straayer: \&quot;thanks for being that life-changing spark\&quot;\r https://t.co/LM3CghawTa #copolit��_&quot; 
## [10] &quot;I visited the @CSUEnergy Powerhouse Energy Campus w/ @ColoradoStateU President Franks to learn more about CSU&#39;s cut��_ https://t.co/uTE7M7v7VN&quot;    
## [11] &quot;Met with @ColoradoStateU Chancellor Frank &amp;amp; Vice Chancellor Parsons. My staffers who are fellow Rams joined! https://t.co/bF7LArS9Bw&quot;          
## [12] &quot;Congrats to @CSUWomensBball on capturing another Mountain West title &amp;amp; being ranked #22 in the country. Go Rams! https://t.co/wawv4CNZLs&quot;      
## [13] &quot;Appreciate Coach Bobo &amp;amp; @CSUFootball backing @CoachToCureMD today. Great cause! #TackleDuchenne!&quot;                                              
## [14] &quot;Nothing beats #AgDay at @ColoradoStateU! Always great being with fellow ram handlers at a @CSUFootball game. http://t.co/v32OhG1Kej&quot;               
## [15] &quot;@mitchellbyars @RepJaredPolis There is nothing more stylish than a @ColoradoStateU Rams shirt!&quot;                                                    
## [16] &quot;Great to be back in Ft Collins at my alma mater @ColoradoStateU. Thanks @CSUTonyFrank for the hospitality, &amp;amp; go Rams http://t.co/zdIcrsgSdL&quot;   
## [17] &quot;Great day to be at the @NationalWestern on CSU Day! And thanks to @BoydPolhamus for the introduction! #NWSS2015 http://t.co/fc46YhoUXg&quot;            
## [18] &quot;Go @CSUfootball! #CSURams #BringBackTheBoot Win the #BorderWar&quot;                                                                                    
## [19] &quot;@RepMarthaRoby I&#39;m proud to be a #CSURam  @CSUFootball&quot;                                                                                            
## [20] &quot;Go @CSUFootball!!!@UA_Athletics: Happy #RollTide Friday! RT if you&#39;re ready for @AlabamaFTBL vs. Colorado State! #CSUvsBAMA&quot;                       
## [21] &quot;#GoRams! #RMShowdown. @CSUfootball: #BeatTheBuffs. -cg&quot;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Which Colorado senator tweets the most about University of Colorado? Use a
similar approach to Question 7, with strings related to CU, such as “Buffs” or
“University of Colorado”.</li>
</ol>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="rprog3.html#cb246-1" tabindex="-1"></a><span class="co"># number of cu-related tweets by senator per year</span></span>
<span id="cb246-2"><a href="rprog3.html#cb246-2" tabindex="-1"></a>tweets_co <span class="sc">%&gt;%</span></span>
<span id="cb246-3"><a href="rprog3.html#cb246-3" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">group_by</span>(user, lubridate<span class="sc">::</span><span class="fu">year</span>(date)) <span class="sc">%&gt;%</span></span>
<span id="cb246-4"><a href="rprog3.html#cb246-4" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="fu">year</span>(date) <span class="sc">&gt;=</span> <span class="dv">2013</span>) <span class="sc">%&gt;%</span></span>
<span id="cb246-5"><a href="rprog3.html#cb246-5" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(stringr<span class="sc">::</span><span class="fu">str_detect</span>(text, </span>
<span id="cb246-6"><a href="rprog3.html#cb246-6" tabindex="-1"></a>                                    <span class="st">&quot;CU|Buffs|buffs|University of Colorado&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb246-7"><a href="rprog3.html#cb246-7" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">tally</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb246-8"><a href="rprog3.html#cb246-8" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">ungroup</span>()</span></code></pre></div>
<pre><code>## # A tibble: 9 × 3
##   user           `lubridate::year(date)`     n
##   &lt;chr&gt;                            &lt;dbl&gt; &lt;int&gt;
## 1 SenBennetCO                       2013     3
## 2 SenBennetCO                       2014     2
## 3 SenBennetCO                       2015     3
## 4 SenBennetCO                       2016     3
## 5 SenBennetCO                       2017     3
## 6 SenCoryGardner                    2013     6
## 7 SenCoryGardner                    2015    11
## 8 SenCoryGardner                    2016     5
## 9 SenCoryGardner                    2017     3</code></pre>
</div>
</div>
<div id="chapter-6-homework" class="section level2 hasAnchor" number="6.7">
<h2><span class="header-section-number">6.7</span> Chapter 6 Homework<a href="rprog3.html#chapter-6-homework" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>You will continue to use the <a href="https://github.com/fivethirtyeight/data/tree/master/twitter-ratio" target="_blank">FiveThirtyEight</a> Twitter data for homework.</p>
<p>Download the csv from Canvas containing Colorado senators’ tweets from 2011 to
2017 (not the full data file used in the above exercises) and the R Markdown
template. Your knitted submission is due at the start of the first class of the
next chapter.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="eda1.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="eda2.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
