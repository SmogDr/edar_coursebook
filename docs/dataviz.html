<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Data Visualization: ggplot2 | Engineering Data Analysis in R</title>
  <meta name="description" content="This is an undergraduate technical elective course for mechanical engineers who wish to lean about data analysis using the R programming language." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Data Visualization: ggplot2 | Engineering Data Analysis in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is an undergraduate technical elective course for mechanical engineers who wish to lean about data analysis using the R programming language." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Data Visualization: ggplot2 | Engineering Data Analysis in R" />
  
  <meta name="twitter:description" content="This is an undergraduate technical elective course for mechanical engineers who wish to lean about data analysis using the R programming language." />
  

<meta name="author" content="John Volckens" />


<meta name="date" content="2020-06-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="rprog2.html"/>
<link rel="next" href="eda1.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Engineering Data Analysis in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#how-to-use-this-book"><i class="fa fa-check"></i><b>1.1</b> How to use this book</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>1.2</b> Prerequisites</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#grading"><i class="fa fa-check"></i><b>1.3</b> Grading</a><ul>
<li class="chapter" data-level="1.3.1" data-path="index.html"><a href="index.html#grading-for-mech-481a6"><i class="fa fa-check"></i><b>1.3.1</b> Grading for MECH 481A6</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#course-set-up"><i class="fa fa-check"></i><b>1.4</b> Course set-up</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#coursebook"><i class="fa fa-check"></i><b>1.5</b> Coursebook</a><ul>
<li class="chapter" data-level="1.5.1" data-path="index.html"><a href="index.html#other-helpful-books-not-required"><i class="fa fa-check"></i><b>1.5.1</b> Other helpful books (not required)</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i><b>1.6</b> Acknowledgements</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="rprog1.html"><a href="rprog1.html"><i class="fa fa-check"></i><b>2</b> The R Programming Environment</a><ul>
<li class="chapter" data-level="2.1" data-path="rprog1.html"><a href="rprog1.html#objectives"><i class="fa fa-check"></i><b>2.1</b> Objectives</a></li>
<li class="chapter" data-level="2.2" data-path="rprog1.html"><a href="rprog1.html#r-and-r-studio"><i class="fa fa-check"></i><b>2.2</b> R and R Studio</a><ul>
<li class="chapter" data-level="2.2.1" data-path="rprog1.html"><a href="rprog1.html#what-is-r"><i class="fa fa-check"></i><b>2.2.1</b> What is R?</a></li>
<li class="chapter" data-level="2.2.2" data-path="rprog1.html"><a href="rprog1.html#free-and-open-source-software"><i class="fa fa-check"></i><b>2.2.2</b> Free and open-source software</a></li>
<li class="chapter" data-level="2.2.3" data-path="rprog1.html"><a href="rprog1.html#what-is-rstudio"><i class="fa fa-check"></i><b>2.2.3</b> What is RStudio?</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="rprog1.html"><a href="rprog1.html#communicating-with-r"><i class="fa fa-check"></i><b>2.3</b> Communicating with R</a><ul>
<li class="chapter" data-level="2.3.1" data-path="rprog1.html"><a href="rprog1.html#r-sessions-the-console-and-the-command-prompt"><i class="fa fa-check"></i><b>2.3.1</b> R sessions, the console, and the command prompt</a></li>
<li class="chapter" data-level="2.3.2" data-path="rprog1.html"><a href="rprog1.html#r-expressions-function-calls-and-objects"><i class="fa fa-check"></i><b>2.3.2</b> R expressions, function calls, and objects</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="rprog1.html"><a href="rprog1.html#r-scripts"><i class="fa fa-check"></i><b>2.4</b> R scripts</a><ul>
<li class="chapter" data-level="2.4.1" data-path="rprog1.html"><a href="rprog1.html#commenting-code"><i class="fa fa-check"></i><b>2.4.1</b> Commenting code</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="rprog1.html"><a href="rprog1.html#the-package-system"><i class="fa fa-check"></i><b>2.5</b> The “package” system</a><ul>
<li class="chapter" data-level="2.5.1" data-path="rprog1.html"><a href="rprog1.html#r-packages"><i class="fa fa-check"></i><b>2.5.1</b> R packages</a></li>
<li class="chapter" data-level="2.5.2" data-path="rprog1.html"><a href="rprog1.html#installing-from-cran"><i class="fa fa-check"></i><b>2.5.2</b> Installing from CRAN</a></li>
<li class="chapter" data-level="2.5.3" data-path="rprog1.html"><a href="rprog1.html#loading-an-installed-package"><i class="fa fa-check"></i><b>2.5.3</b> Loading an installed package</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="rprog1.html"><a href="rprog1.html#rs-most-basic-object-types"><i class="fa fa-check"></i><b>2.6</b> R’s most basic object types</a><ul>
<li class="chapter" data-level="2.6.1" data-path="rprog1.html"><a href="rprog1.html#vectors"><i class="fa fa-check"></i><b>2.6.1</b> Vectors</a></li>
<li class="chapter" data-level="2.6.2" data-path="rprog1.html"><a href="rprog1.html#dataframes"><i class="fa fa-check"></i><b>2.6.2</b> Dataframes</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="rprog2.html"><a href="rprog2.html"><i class="fa fa-check"></i><b>3</b> Getting and Cleaning Data</a><ul>
<li class="chapter" data-level="3.1" data-path="rprog2.html"><a href="rprog2.html#objectives-1"><i class="fa fa-check"></i><b>3.1</b> Objectives</a></li>
<li class="chapter" data-level="3.2" data-path="rprog2.html"><a href="rprog2.html#overview"><i class="fa fa-check"></i><b>3.2</b> Overview</a></li>
<li class="chapter" data-level="3.3" data-path="rprog2.html"><a href="rprog2.html#reading-data-into-r"><i class="fa fa-check"></i><b>3.3</b> Reading data into R</a><ul>
<li class="chapter" data-level="3.3.1" data-path="rprog2.html"><a href="rprog2.html#reading-local-flat-files"><i class="fa fa-check"></i><b>3.3.1</b> Reading local flat files</a></li>
<li class="chapter" data-level="3.3.2" data-path="rprog2.html"><a href="rprog2.html#reading-in-other-file-types"><i class="fa fa-check"></i><b>3.3.2</b> Reading in other file types</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="rprog2.html"><a href="rprog2.html#directories-and-pathnames"><i class="fa fa-check"></i><b>3.4</b> Directories and pathnames</a><ul>
<li class="chapter" data-level="3.4.1" data-path="rprog2.html"><a href="rprog2.html#directory-structure"><i class="fa fa-check"></i><b>3.4.1</b> Directory structure</a></li>
<li class="chapter" data-level="3.4.2" data-path="rprog2.html"><a href="rprog2.html#working-directory"><i class="fa fa-check"></i><b>3.4.2</b> Working directory</a></li>
<li class="chapter" data-level="3.4.3" data-path="rprog2.html"><a href="rprog2.html#file-and-directory-pathnames"><i class="fa fa-check"></i><b>3.4.3</b> File and directory pathnames</a></li>
<li class="chapter" data-level="3.4.4" data-path="rprog2.html"><a href="rprog2.html#diversion-paste"><i class="fa fa-check"></i><b>3.4.4</b> Diversion: <code>paste</code></a></li>
<li class="chapter" data-level="3.4.5" data-path="rprog2.html"><a href="rprog2.html#reading-online-flat-files"><i class="fa fa-check"></i><b>3.4.5</b> Reading online flat files</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="rprog2.html"><a href="rprog2.html#data-cleaning"><i class="fa fa-check"></i><b>3.5</b> Data cleaning</a><ul>
<li class="chapter" data-level="3.5.1" data-path="rprog2.html"><a href="rprog2.html#renaming-columns"><i class="fa fa-check"></i><b>3.5.1</b> Renaming columns</a></li>
<li class="chapter" data-level="3.5.2" data-path="rprog2.html"><a href="rprog2.html#selecting-columns"><i class="fa fa-check"></i><b>3.5.2</b> Selecting columns</a></li>
<li class="chapter" data-level="3.5.3" data-path="rprog2.html"><a href="rprog2.html#add-or-change-columns"><i class="fa fa-check"></i><b>3.5.3</b> Add or change columns</a></li>
<li class="chapter" data-level="3.5.4" data-path="rprog2.html"><a href="rprog2.html#base-r-equivalents-to-dplyr-functions"><i class="fa fa-check"></i><b>3.5.4</b> Base R equivalents to <code>dplyr</code> functions</a></li>
<li class="chapter" data-level="3.5.5" data-path="rprog2.html"><a href="rprog2.html#filtering-to-certain-rows"><i class="fa fa-check"></i><b>3.5.5</b> Filtering to certain rows</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="rprog2.html"><a href="rprog2.html#piping"><i class="fa fa-check"></i><b>3.6</b> Piping</a></li>
<li class="chapter" data-level="3.7" data-path="rprog2.html"><a href="rprog2.html#in-course-exercise"><i class="fa fa-check"></i><b>3.7</b> In-course Exercise</a><ul>
<li class="chapter" data-level="3.7.1" data-path="rprog2.html"><a href="rprog2.html#downloading-and-checking-out-the-example-data"><i class="fa fa-check"></i><b>3.7.1</b> Downloading and checking out the example data</a></li>
<li class="chapter" data-level="3.7.2" data-path="rprog2.html"><a href="rprog2.html#reading-in-different-types-of-files"><i class="fa fa-check"></i><b>3.7.2</b> Reading in different types of files</a></li>
<li class="chapter" data-level="3.7.3" data-path="rprog2.html"><a href="rprog2.html#directory-structure-1"><i class="fa fa-check"></i><b>3.7.3</b> Directory structure</a></li>
<li class="chapter" data-level="3.7.4" data-path="rprog2.html"><a href="rprog2.html#cleaning-up-data-1"><i class="fa fa-check"></i><b>3.7.4</b> Cleaning up data #1</a></li>
<li class="chapter" data-level="3.7.5" data-path="rprog2.html"><a href="rprog2.html#cleaning-up-data-2"><i class="fa fa-check"></i><b>3.7.5</b> Cleaning up data #2</a></li>
<li class="chapter" data-level="3.7.6" data-path="rprog2.html"><a href="rprog2.html#piping-1"><i class="fa fa-check"></i><b>3.7.6</b> Piping</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>4</b> Data Visualization: ggplot2</a><ul>
<li class="chapter" data-level="4.1" data-path="dataviz.html"><a href="dataviz.html#install-and-call-ggplot2"><i class="fa fa-check"></i><b>4.1</b> Install and call <code>ggplot2</code></a><ul>
<li class="chapter" data-level="4.1.1" data-path="dataviz.html"><a href="dataviz.html#initializing-a-ggplot-object"><i class="fa fa-check"></i><b>4.1.1</b> Initializing a ggplot object</a></li>
<li class="chapter" data-level="4.1.2" data-path="dataviz.html"><a href="dataviz.html#plot-aesthetics"><i class="fa fa-check"></i><b>4.1.2</b> Plot aesthetics</a></li>
<li class="chapter" data-level="4.1.3" data-path="dataviz.html"><a href="dataviz.html#adding-geoms"><i class="fa fa-check"></i><b>4.1.3</b> Adding geoms</a></li>
<li class="chapter" data-level="4.1.4" data-path="dataviz.html"><a href="dataviz.html#aesthetic-override-a-warning"><i class="fa fa-check"></i><b>4.1.4</b> Aesthetic override: a warning</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="dataviz.html"><a href="dataviz.html#shapes-and-colors"><i class="fa fa-check"></i><b>4.2</b> Shapes and colors</a></li>
<li class="chapter" data-level="4.3" data-path="dataviz.html"><a href="dataviz.html#scales-useful-plot-edits"><i class="fa fa-check"></i><b>4.3</b> Scales: useful plot edits</a></li>
<li class="chapter" data-level="4.4" data-path="dataviz.html"><a href="dataviz.html#example-plot"><i class="fa fa-check"></i><b>4.4</b> Example plot</a></li>
<li class="chapter" data-level="4.5" data-path="dataviz.html"><a href="dataviz.html#store-and-save-ggplot2-objects"><i class="fa fa-check"></i><b>4.5</b> Store and save ggplot2 objects</a></li>
<li class="chapter" data-level="4.6" data-path="dataviz.html"><a href="dataviz.html#getting-help-with-ggplot2"><i class="fa fa-check"></i><b>4.6</b> Getting help with ggplot2</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="eda1.html"><a href="eda1.html"><i class="fa fa-check"></i><b>5</b> Univariate Data Exploration</a><ul>
<li class="chapter" data-level="5.1" data-path="eda1.html"><a href="eda1.html#objectives-2"><i class="fa fa-check"></i><b>5.1</b> Objectives</a></li>
<li class="chapter" data-level="5.2" data-path="eda1.html"><a href="eda1.html#univariate-data"><i class="fa fa-check"></i><b>5.2</b> Univariate Data</a><ul>
<li class="chapter" data-level="5.2.1" data-path="eda1.html"><a href="eda1.html#location-dispersion-and-shape"><i class="fa fa-check"></i><b>5.2.1</b> Location, Dispersion, and Shape</a></li>
<li class="chapter" data-level="5.2.2" data-path="eda1.html"><a href="eda1.html#example-location-and-dispersion"><i class="fa fa-check"></i><b>5.2.2</b> Example: Location and Dispersion</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="eda1.html"><a href="eda1.html#quantiles"><i class="fa fa-check"></i><b>5.3</b> Quantiles</a><ul>
<li class="chapter" data-level="5.3.1" data-path="eda1.html"><a href="eda1.html#quantiles-and-descriptive-statistics"><i class="fa fa-check"></i><b>5.3.1</b> Quantiles and Descriptive Statistics</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="eda1.html"><a href="eda1.html#univariate-data-visualization"><i class="fa fa-check"></i><b>5.4</b> Univariate Data Visualization</a></li>
<li class="chapter" data-level="5.5" data-path="eda1.html"><a href="eda1.html#cumulative-distribution-plot"><i class="fa fa-check"></i><b>5.5</b> Cumulative Distribution Plot</a><ul>
<li class="chapter" data-level="5.5.1" data-path="eda1.html"><a href="eda1.html#cumulative-distribution-plot-example"><i class="fa fa-check"></i><b>5.5.1</b> Cumulative Distribution Plot Example</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="eda1.html"><a href="eda1.html#hist"><i class="fa fa-check"></i><b>5.6</b> Histogram</a><ul>
<li class="chapter" data-level="5.6.1" data-path="eda1.html"><a href="eda1.html#histogram-what-to-look-for"><i class="fa fa-check"></i><b>5.6.1</b> Histogram: what to look for?</a></li>
<li class="chapter" data-level="5.6.2" data-path="eda1.html"><a href="eda1.html#what-causes-skewed-histograms"><i class="fa fa-check"></i><b>5.6.2</b> What causes skewed histograms?</a></li>
<li class="chapter" data-level="5.6.3" data-path="eda1.html"><a href="eda1.html#pdf"><i class="fa fa-check"></i><b>5.6.3</b> Probability Density Function</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="eda1.html"><a href="eda1.html#time_series"><i class="fa fa-check"></i><b>5.7</b> Time-Series</a></li>
<li class="chapter" data-level="5.8" data-path="eda1.html"><a href="eda1.html#autocorr"><i class="fa fa-check"></i><b>5.8</b> Autocorrelation</a><ul>
<li class="chapter" data-level="5.8.1" data-path="eda1.html"><a href="eda1.html#partial-autocorrelation"><i class="fa fa-check"></i><b>5.8.1</b> Partial Autocorrelation</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="eda1.html"><a href="eda1.html#in-course-exercises"><i class="fa fa-check"></i><b>5.9</b> In-course Exercises</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="rprog3.html"><a href="rprog3.html"><i class="fa fa-check"></i><b>6</b> Dates, Strings, and Tidying</a><ul>
<li class="chapter" data-level="6.1" data-path="rprog3.html"><a href="rprog3.html#objectives-3"><i class="fa fa-check"></i><b>6.1</b> Objectives</a></li>
<li class="chapter" data-level="6.2" data-path="rprog3.html"><a href="rprog3.html#dates"><i class="fa fa-check"></i><b>6.2</b> Dates</a></li>
<li class="chapter" data-level="6.3" data-path="rprog3.html"><a href="rprog3.html#dates-in-r"><i class="fa fa-check"></i><b>6.3</b> Dates in R</a></li>
<li class="chapter" data-level="6.4" data-path="rprog3.html"><a href="rprog3.html#strings"><i class="fa fa-check"></i><b>6.4</b> Strings</a><ul>
<li class="chapter" data-level="6.4.1" data-path="rprog3.html"><a href="rprog3.html#string-detect-match"><i class="fa fa-check"></i><b>6.4.1</b> String detect &amp; match</a></li>
<li class="chapter" data-level="6.4.2" data-path="rprog3.html"><a href="rprog3.html#regular-expressions"><i class="fa fa-check"></i><b>6.4.2</b> Regular Expressions</a></li>
<li class="chapter" data-level="6.4.3" data-path="rprog3.html"><a href="rprog3.html#string-split-separate"><i class="fa fa-check"></i><b>6.4.3</b> String split &amp; separate</a></li>
<li class="chapter" data-level="6.4.4" data-path="rprog3.html"><a href="rprog3.html#string-extract-remove"><i class="fa fa-check"></i><b>6.4.4</b> String extract &amp; remove</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="rprog3.html"><a href="rprog3.html#tidy-data"><i class="fa fa-check"></i><b>6.5</b> Tidy Data</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="eda2.html"><a href="eda2.html"><i class="fa fa-check"></i><b>7</b> Multivariate Data Exploration</a><ul>
<li class="chapter" data-level="7.1" data-path="eda2.html"><a href="eda2.html#objectives-4"><i class="fa fa-check"></i><b>7.1</b> Objectives</a></li>
<li class="chapter" data-level="7.2" data-path="eda2.html"><a href="eda2.html#bivariate"><i class="fa fa-check"></i><b>7.2</b> Bivariate Data</a></li>
<li class="chapter" data-level="7.3" data-path="eda2.html"><a href="eda2.html#scatt"><i class="fa fa-check"></i><b>7.3</b> Scatterplot</a><ul>
<li class="chapter" data-level="7.3.1" data-path="eda2.html"><a href="eda2.html#causality"><i class="fa fa-check"></i><b>7.3.1</b> Causality</a></li>
<li class="chapter" data-level="7.3.2" data-path="eda2.html"><a href="eda2.html#correlation"><i class="fa fa-check"></i><b>7.3.2</b> Correlation</a></li>
<li class="chapter" data-level="7.3.3" data-path="eda2.html"><a href="eda2.html#correlation-neq-causation"><i class="fa fa-check"></i><b>7.3.3</b> Correlation <span class="math inline">\(\neq\)</span> causation</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="eda2.html"><a href="eda2.html#QQ"><i class="fa fa-check"></i><b>7.4</b> Q-Q Plot (Quantile-Quantile)</a></li>
<li class="chapter" data-level="7.5" data-path="eda2.html"><a href="eda2.html#Tukey"><i class="fa fa-check"></i><b>7.5</b> Tukey Mean Difference Plot</a></li>
<li class="chapter" data-level="7.6" data-path="eda2.html"><a href="eda2.html#boxplot-box"><i class="fa fa-check"></i><b>7.6</b> Boxplot (#box)</a></li>
<li class="chapter" data-level="7.7" data-path="eda2.html"><a href="eda2.html#exploring-multivariate-data"><i class="fa fa-check"></i><b>7.7</b> Exploring Multivariate Data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="rprog4.html"><a href="rprog4.html"><i class="fa fa-check"></i><b>8</b> Functional Programming</a><ul>
<li class="chapter" data-level="8.1" data-path="rprog4.html"><a href="rprog4.html#step-iii-1"><i class="fa fa-check"></i><b>8.1</b> Step III-1</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="eda3.html"><a href="eda3.html"><i class="fa fa-check"></i><b>9</b> Tips and Tricks for Data Exploration</a><ul>
<li class="chapter" data-level="9.1" data-path="eda3.html"><a href="eda3.html#transformation"><i class="fa fa-check"></i><b>9.1</b> Transformation</a></li>
<li class="chapter" data-level="9.2" data-path="eda3.html"><a href="eda3.html#centering"><i class="fa fa-check"></i><b>9.2</b> Centering</a></li>
<li class="chapter" data-level="9.3" data-path="eda3.html"><a href="eda3.html#normalizing"><i class="fa fa-check"></i><b>9.3</b> Normalizing</a><ul>
<li class="chapter" data-level="9.3.1" data-path="eda3.html"><a href="eda3.html#standardizing"><i class="fa fa-check"></i><b>9.3.1</b> Standardizing</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="eda3.html"><a href="eda3.html#stratification"><i class="fa fa-check"></i><b>9.4</b> Stratification</a></li>
<li class="chapter" data-level="9.5" data-path="eda3.html"><a href="eda3.html#censoring-and-truncating"><i class="fa fa-check"></i><b>9.5</b> Censoring and Truncating</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="measure.html"><a href="measure.html"><i class="fa fa-check"></i><b>10</b> Measurement</a><ul>
<li class="chapter" data-level="10.1" data-path="measure.html"><a href="measure.html#sampling"><i class="fa fa-check"></i><b>10.1</b> Sampling</a><ul>
<li class="chapter" data-level="10.1.1" data-path="measure.html"><a href="measure.html#samples-vs.populations"><i class="fa fa-check"></i><b>10.1.1</b> Samples vs. Populations</a></li>
<li class="chapter" data-level="10.1.2" data-path="measure.html"><a href="measure.html#collecting-a-sample"><i class="fa fa-check"></i><b>10.1.2</b> Collecting a sample</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="measure.html"><a href="measure.html#figures-of-merit"><i class="fa fa-check"></i><b>10.2</b> Figures of Merit</a><ul>
<li class="chapter" data-level="10.2.1" data-path="measure.html"><a href="measure.html#accuracy"><i class="fa fa-check"></i><b>10.2.1</b> Accuracy</a></li>
<li class="chapter" data-level="10.2.2" data-path="measure.html"><a href="measure.html#precision"><i class="fa fa-check"></i><b>10.2.2</b> Precision</a></li>
<li class="chapter" data-level="10.2.3" data-path="measure.html"><a href="measure.html#bias"><i class="fa fa-check"></i><b>10.2.3</b> Bias</a></li>
<li class="chapter" data-level="10.2.4" data-path="measure.html"><a href="measure.html#limit-of-detection"><i class="fa fa-check"></i><b>10.2.4</b> Limit of Detection</a></li>
<li class="chapter" data-level="10.2.5" data-path="measure.html"><a href="measure.html#failure-and-reliability"><i class="fa fa-check"></i><b>10.2.5</b> Failure and Reliability</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="model.html"><a href="model.html"><i class="fa fa-check"></i><b>11</b> Modeling</a><ul>
<li class="chapter" data-level="11.1" data-path="model.html"><a href="model.html#fitting"><i class="fa fa-check"></i><b>11.1</b> Fitting</a></li>
<li class="chapter" data-level="11.2" data-path="model.html"><a href="model.html#linear-models"><i class="fa fa-check"></i><b>11.2</b> Linear Models</a><ul>
<li class="chapter" data-level="11.2.1" data-path="model.html"><a href="model.html#assumptions-of-linear-regression"><i class="fa fa-check"></i><b>11.2.1</b> Assumptions of Linear Regression</a></li>
<li class="chapter" data-level="11.2.2" data-path="model.html"><a href="model.html#diagnostics"><i class="fa fa-check"></i><b>11.2.2</b> Diagnostics</a></li>
<li class="chapter" data-level="11.2.3" data-path="model.html"><a href="model.html#ordinary-least-squares"><i class="fa fa-check"></i><b>11.2.3</b> Ordinary Least Squares</a></li>
<li class="chapter" data-level="11.2.4" data-path="model.html"><a href="model.html#weighted-least-squares"><i class="fa fa-check"></i><b>11.2.4</b> Weighted Least Squares</a></li>
<li class="chapter" data-level="11.2.5" data-path="model.html"><a href="model.html#deming-regression"><i class="fa fa-check"></i><b>11.2.5</b> Deming Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="simulate.html"><a href="simulate.html"><i class="fa fa-check"></i><b>12</b> Simulation</a><ul>
<li class="chapter" data-level="12.1" data-path="simulate.html"><a href="simulate.html#introduction-to-simulation"><i class="fa fa-check"></i><b>12.1</b> Introduction to simulation</a></li>
<li class="chapter" data-level="12.2" data-path="simulate.html"><a href="simulate.html#simulation-example"><i class="fa fa-check"></i><b>12.2</b> Simulation Example:</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="dist.html"><a href="dist.html"><i class="fa fa-check"></i><b>13</b> Appendix: Reference Distributions</a><ul>
<li class="chapter" data-level="13.1" data-path="dist.html"><a href="dist.html#unif_dist"><i class="fa fa-check"></i><b>13.1</b> Uniform Distribution</a><ul>
<li class="chapter" data-level="13.1.1" data-path="dist.html"><a href="dist.html#characteristic-plots-uniform-distribution"><i class="fa fa-check"></i><b>13.1.1</b> Characteristic Plots: Uniform Distribution</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="dist.html"><a href="dist.html#normal_dist"><i class="fa fa-check"></i><b>13.2</b> Normal Distribution</a><ul>
<li class="chapter" data-level="13.2.1" data-path="dist.html"><a href="dist.html#normal-distribution-characteristic-plots"><i class="fa fa-check"></i><b>13.2.1</b> Normal Distribution: Characteristic Plots</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="dist.html"><a href="dist.html#log_normal_dist"><i class="fa fa-check"></i><b>13.3</b> Log-normal Distribution</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Engineering Data Analysis in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dataviz" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Data Visualization: ggplot2</h1>
<div id="install-and-call-ggplot2" class="section level2">
<h2><span class="header-section-number">4.1</span> Install and call <code>ggplot2</code></h2>
<blockquote>
<p><span style="color: blue;"> The best design gets out of the way between the viewer’s brain and the content. - Edward Tufte </span></p>
</blockquote>
<p>In this chapter, you will learn how to make basic plots using the <code>ggplot2</code> package in R (also part of the Tidyverse). This section will focus on making <strong>useful</strong>, rather than <strong>attractive</strong> graphs, since at this stage we are focusing on exploring data for yourself rather than presenting results to others. Later on, I will explain more about how you can customize ggplot objects, to help you make plots that “get out the way” between the content you wish to present and the viewer’s brain, where you hope understanding takes root.</p>
<p>If you don’t already have <code>ggplot2</code> installed, you’ll need to install it. You then need to load the package in your current session of R:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">&quot;ggplot2&quot;</span>)  </a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<p>The process of creating a plot using <code>ggplot2</code> follows conventions that are a bit different than most of the code you’ve seen so far in R (although it is somewhat similar to the idea of piping I introduced in the last chapter). The basic steps behind creating a plot with <code>ggplot2</code> are:</p>
<ol style="list-style-type: decimal">
<li><p>Create an object of the <code>ggplot</code> class, typically specifying the <strong>data</strong> and some or all of the <strong>aesthetics</strong>;</p></li>
<li><p>Add a layer or <strong>geom</strong> to the plot, along with other specific elements, using <code>+</code>.</p></li>
</ol>
<blockquote>
<p><strong>Aesthetics</strong> or <code>aes</code> in R represent the things that we are plotting; the x and y data. <strong>Geoms</strong> like <code>geom_point</code> represent the way in which we layer the aesthetics onto the plot. The geom is the type of plot that we are calling.</p>
</blockquote>
<p>You can layer on one or many geoms and other elements to create plots that range from very simple to very customized. We will start by focusing on simple geoms and added elements; later on, we will explore more detailed customization.</p>
<div class="rmdwarning">
<p>
A common error when writing <code>ggplot2</code> code is to put the <code>+</code> to add a geom or element at the beginning of a line rather than the end of a previous line– in this case, R will try to execute the call too soon. If R gets to the end of a line and there is no indication to continue the call (e.g., <code>%&gt;%</code> for piping or <code>+</code> for <code>ggplot2</code> plots), R interprets that as a message to run the call without reading in further code. Thus, to avoid errors, be sure to end each line in <code>ggplot</code> calls with <code>+</code> (except for the final line when the call is actually over); don’t start lines with <code>+</code>.
</p>
</div>
<div id="initializing-a-ggplot-object" class="section level3">
<h3><span class="header-section-number">4.1.1</span> Initializing a ggplot object</h3>
<p>The first step in creating a plot using <code>ggplot2</code> is to create a ggplot object. This object will not, by itself, create a plot with anything in it. Instead, this first step typically specifies the data frame you want to use and which aesthetics will be mapped to certain columns of that data frame (aesthetics are explained more in the next subsection).</p>
<p>Use the following conventions to initialize a ggplot object:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co">## Generic code</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">object &lt;-<span class="st"> </span><span class="kw">ggplot</span>(my_dataframe, <span class="kw">aes</span>(<span class="dt">x =</span> data_column_<span class="dv">1</span>, <span class="dt">y =</span> data_column_<span class="dv">2</span>))</a></code></pre></div>
<p>The data frame is the first parameter in a <code>ggplot</code> call and, if you like, you can use the parameter definition with that call (e.g., <code>data = dataframe</code>). Aesthetics are defined within an <code>aes</code> function call that typically is used within the <code>ggplot</code> call.</p>
<div class="rmdnote">
<p>
While the <code>ggplot</code> call is the place where you will most often see an <code>aes</code> call, you can also make calls to <code>aes</code> within the calls to specific geoms. This can be particularly useful if you want to map aesthetics differently for different geoms in your plot. We’ll see some examples of this use of <code>aes</code> more in later sections, when we talk about customizing plots. The <code>data</code> parameter can also be used in geom calls, to use a different data frame from the one defined when creating the original ggplot object, although this tends to be less common.
</p>
</div>
</div>
<div id="plot-aesthetics" class="section level3">
<h3><span class="header-section-number">4.1.2</span> Plot aesthetics</h3>
<p><strong>Aesthetics</strong> are properties of the plot that can show certain elements of the data. For example, in Figure <a href="dataviz.html#fig:mpg-1">4.1</a>, we call an x-axis aesthetic (<code>x = class</code>) from the <code>mpg</code> dataset. We then plot counts of cars within different vehicle classes using <code>geom_bar</code>. The <code>mpg</code> dataframe is included with the ggplot2 package; you can learn more about it by typing <code>?mpg</code> into the console after loading ggplot2 (<code>library(ggplot2)</code>). You can also learn more by typing <code>str(mpg)</code> and <code>head(mpg)</code> - always a good practice when looking at a new dataframe!</p>
<p>According to <code>?mpg</code>:<br />
&gt; “This dataset contains a subset of the fuel economy data that the EPA makes available on <a href="http://fueleconomy.gov">http://fueleconomy.gov</a>. It contains only models which had a new release every year between 1999 and 2008 - this was used as a proxy for the popularity of the car.”</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="co"># call to ggplot to map the data and a single aesthetic</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> class)) <span class="op">+</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="co"># call to a specific geom to plot the mapped data</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="kw">geom_bar</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:mpg-1"></span>
<img src="04-dataviz_files/figure-html/mpg-1-1.png" alt="Example of a simple call to `ggplot` showing counts of vehicle classes from the `mpg` dataframe." width="672" />
<p class="caption">
Figure 4.1: Example of a simple call to <code>ggplot</code> showing counts of vehicle classes from the <code>mpg</code> dataframe.
</p>
</div>
<p>Let’s call this plot again with a second aesthetic, the <code>fill</code> color, which will be mapped to vehicle drive type (4-wheel, font-wheel, rear-wheel). The x-position will continue to show vehicle class, and the y-position will show the counts of vehicles, now colored by the drive types.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># call to ggplot to map the data and a single aesthetic</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">fill =</span> drv)) <span class="op">+</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="st">  </span><span class="co"># call to a specific geom to plot the mapped data</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="kw">geom_bar</span>()</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:mpg-2"></span>
<img src="04-dataviz_files/figure-html/mpg-2-1.png" alt="Example of a call to `ggplot` showing counts of vehicle classes from the `mpg` dataframe and colored by the `fill` aesthetic mapped to drive type (`drv`)." width="672" />
<p class="caption">
Figure 4.2: Example of a call to <code>ggplot</code> showing counts of vehicle classes from the <code>mpg</code> dataframe and colored by the <code>fill</code> aesthetic mapped to drive type (<code>drv</code>).
</p>
</div>
<div class="rmdnote">
<p>
<code>ggplot</code> will naturally choose colors and add legends to plots when an aesthetic mapping creates such opportunities. You will learn ways to customize colors, legends, and other plot elements later on.
</p>
</div>
<p>Which aesthetics are required for a plot depend on which geoms (more on those in a second) you’re adding to the plot. You can find out the aesthetics you can use for a geom in the “Aesthetics” section of the geom’s help file (e.g., <code>?geom_bar</code>). Required aesthetics are in bold in this section of the help file and optional ones are not. Common plot aesthetics you might want to specify include:</p>
<table>
<caption>
<span id="tab:unnamed-chunk-4">Table 4.1: </span>Common Plot Aesthetics
</caption>
<thead>
<tr>
<th style="text-align:left;">
Code
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>x</code>
</td>
<td style="text-align:left;">
Position on x-axis
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>y</code>
</td>
<td style="text-align:left;">
Position on y-axis
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>shape</code>
</td>
<td style="text-align:left;">
Shape
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>color</code>
</td>
<td style="text-align:left;">
Color of border of elements
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>fill</code>
</td>
<td style="text-align:left;">
Color of inside of elements
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>size</code>
</td>
<td style="text-align:left;">
Size
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>alpha</code>
</td>
<td style="text-align:left;">
Transparency (1: opaque; 0: transparent)
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>linetype</code>
</td>
<td style="text-align:left;">
Type of line (e.g., solid, dashed)
</td>
</tr>
</tbody>
</table>
</div>
<div id="adding-geoms" class="section level3">
<h3><span class="header-section-number">4.1.3</span> Adding geoms</h3>
<p>When creating plots, you’ll often want to add more than one <code>geom</code> to the plot. You can add these with <code>+</code> after the <code>ggplot</code> statement to initialize the ggplot object. Some of the most common geoms are:</p>
<table>
<caption>
<span id="tab:unnamed-chunk-5">Table 4.2: </span>Common Plot Aesthetics
</caption>
<thead>
<tr>
<th style="text-align:left;">
Plot type
</th>
<th style="text-align:left;">
ggplot2 function
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Histogram (1 numeric variable)
</td>
<td style="text-align:left;">
<code>geom_histogram</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Scatterplot (2 numeric variables)
</td>
<td style="text-align:left;">
<code>geom_point</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Boxplot (1 numeric variable, possibly 1 factor variable)
</td>
<td style="text-align:left;">
<code>geom_boxplot</code>
</td>
</tr>
<tr>
<td style="text-align:left;">
Line graph (2 numeric variables)
</td>
<td style="text-align:left;">
<code>geom_line</code>
</td>
</tr>
</tbody>
</table>
</div>
<div id="aesthetic-override-a-warning" class="section level3">
<h3><span class="header-section-number">4.1.4</span> Aesthetic override: a warning</h3>
<p>The <code>ggplot2</code> package, like many Tidyverse packages, is both flexible and forgiving - designed to accomodate the user by “filling in the blanks” when no information is provided. For example, in the ggplot call that created Figure <a href="dataviz.html#fig:mpg-2">4.2</a>, we didn’t specify the colors to be used or the contents of the legend - instead ggplot figured those out for us. The <code>ggplot2</code> package is also somewhat <em>flexibile</em> in how calls and aesthetic mappings can be structured; for example, the following four calls all produce the same (identical) plot as shown in Figure <a href="dataviz.html#fig:mpg-2">4.2</a>. Try it for yourself.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># call to ggplot with aes() specified in main call</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">fill =</span> drv)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="kw">geom_bar</span>()</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co"># call to ggplot with aes() specified in geom</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">fill =</span> drv))</a>
<a class="sourceLine" id="cb5-8" data-line-number="8"></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co"># call to ggplot with a mix of aes() mappings </span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> class)) <span class="op">+</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> drv))</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co"># call to ggplot with all mappings in the geom </span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="kw">geom_bar</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">fill =</span> drv))</a></code></pre></div>
<p>However, this flexibility also comes with occasional confusion, as you can often <strong><em>override</em></strong> one mapping with another one later on in the same call. For example, see what happends when two different <code>fill</code> mappings are specified at different points in the call:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="co"># call to ggplot where one `fill` overrides another</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> class, <span class="dt">fill =</span> drv)) <span class="op">+</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;darkgreen&quot;</span>)</a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:mpg-4"></span>
<img src="04-dataviz_files/figure-html/mpg-4-1.png" alt="Example of a call to `ggplot` showing counts of vehicle classes from the `mpg` dataframe and colored by the `fill` aesthetic mapped to drive type (`drv`)." width="672" />
<p class="caption">
Figure 4.3: Example of a call to <code>ggplot</code> showing counts of vehicle classes from the <code>mpg</code> dataframe and colored by the <code>fill</code> aesthetic mapped to drive type (<code>drv</code>).
</p>
</div>
<p>In this case, the aesthetic mapping of <code>aes(fill = drv)</code> was overridden by the specification in <code>geom_bar()</code>, where we wrote <code>fill = &quot;darkgreen&quot;</code>. This second specification essentially wiped away the stacked bar colors and the legend (as shown in Figure <a href="dataviz.html#fig:mpg-2">4.2</a>). As your <code>ggplot2</code> objects become more customized this sort of issue can arise; it comes with the territory of having flexible code.</p>
</div>
</div>
<div id="shapes-and-colors" class="section level2">
<h2><span class="header-section-number">4.2</span> Shapes and colors</h2>
<p>In R, you can specify the shape of points with a number. Figure <a href="dataviz.html#fig:shapeexamples">4.4</a> shows the shapes that correspond to the numbers 1 to 25 in the <code>shape</code> aesthetic. This figure also provides an example of the difference between color (black for all these example points) and fill (red for these examples). You can see that some point shapes include a fill (21 for example), while some are either empty (1) or solid (19).</p>
<div class="figure" style="text-align: center"><span id="fig:shapeexamples"></span>
<img src="04-dataviz_files/figure-html/shapeexamples-1.png" alt="Examples of the shapes corresponding to different numeric choices for the `shape` aesthetic. For all examples, `color` is set to black and `fill` to red." width="480" />
<p class="caption">
Figure 4.4: Examples of the shapes corresponding to different numeric choices for the <code>shape</code> aesthetic. For all examples, <code>color</code> is set to black and <code>fill</code> to red.
</p>
</div>
<p>If you want to set color to be a constant value, you can do that in R using character strings for different colors. Figure <a href="dataviz.html#fig:colorexamples">4.5</a> gives an example of some of the different blues available in R. To find links to listings of different R colors, google “R colors” and search by “Images”.</p>
<div class="figure" style="text-align: center"><span id="fig:colorexamples"></span>
<img src="04-dataviz_files/figure-html/colorexamples-1.png" alt="Example of available shades of blue in R." width="480" />
<p class="caption">
Figure 4.5: Example of available shades of blue in R.
</p>
</div>
</div>
<div id="scales-useful-plot-edits" class="section level2">
<h2><span class="header-section-number">4.3</span> Scales: useful plot edits</h2>
<p>The ‘ggplot2’ package uses <strong><em>scales</em></strong> to as a way to make all sorts of tweaks and changes to how the plot is presented. According to the <code>ggplot2</code> reference: “Scales control the details of how data values are translated to visual properties. Override the default scales to tweak details like the axis labels or legend keys, or to use a completely different translation from data to aesthetic.”</p>
<p>There are many scale elements that you can add onto a <code>ggplot</code> object using <code>+</code>. A few that are used very frequently are:</p>
<table>
<caption>
<span id="tab:unnamed-chunk-6">Table 4.3: </span>Common Scale Elements
</caption>
<thead>
<tr>
<th style="text-align:left;">
Element
</th>
<th style="text-align:left;">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<code>ggtitle</code>
</td>
<td style="text-align:left;">
Plot title
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>xlab</code>, <code>ylab</code>
</td>
<td style="text-align:left;">
x- and y-axis labels
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>xlim</code>, <code>ylim</code>
</td>
<td style="text-align:left;">
Limits of x- and y-axis
</td>
</tr>
<tr>
<td style="text-align:left;">
<code>scale_x_log10</code>
</td>
<td style="text-align:left;">
Log scale x axis
</td>
</tr>
</tbody>
</table>
</div>
<div id="example-plot" class="section level2">
<h2><span class="header-section-number">4.4</span> Example plot</h2>
<p>For the example plots, we will continue to use the <code>mpg</code> dataset from the <code>ggplot</code> package. We will use functions from the <code>dplyr</code> package, too, so both need to be loaded. In this figure, we will look at highway fuel efficiency for SUVs in 2008, ordered by manufacturer and colored by the engine displacement size in liters. We create subsets of the <code>mpg</code> dataframe in two ways:</p>
<ol style="list-style-type: decimal">
<li>We create a summary dataframe (<code>mpg_5</code>) by applying two <code>filter</code> calls on the <code>mpg</code> object. We then <code>group_by</code> the manufacturer so that average values for highway fuel economy (<code>hwy.mean</code>) and engine displacement (<code>displ.mean</code>) can be calculated through a call to <code>summarise</code>.<br />
</li>
<li>We subset the <code>mpg</code> dataframe again, this time directly within the <code>data =</code> call for <code>ggplot2</code>.</li>
</ol>
<ul>
<li><p>The first layer (<code>geom_jitter</code>) is a point plot that adds a slight amount of wobble or jitter to the data points so that they don’t overlap on the plot. Here, we have called <code>geom_jitter</code> to display the individual values for 2008 SUV fuel economy (on the highway) as a function manufacturer.</p></li>
<li><p>The second layer (<code>geom_errorbar</code>) is a horizontal line plot showing the mean values for SUV models within each manufacturer.</p></li>
</ul>
<p>We also add custom lables and a fancy color scale to investigate whether engine displacement has an effect on fuel efficiency (note the additional aesthetic calls for <code>color =</code> in each layer). The final part of the call <code>theme_classic()</code> tells ggplot to remove the grey background and the grid lines, which I don’t feel are necessary.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co"># use dplyr to create a summary subset from the mpg dataframe</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">mpg_<span class="dv">5</span> &lt;-<span class="st"> </span>mpg <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">  </span><span class="kw">filter</span>(class <span class="op">==</span><span class="st"> &quot;suv&quot;</span>, year <span class="op">==</span><span class="st"> </span><span class="dv">2008</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="st">  </span><span class="kw">group_by</span>(manufacturer) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">hwy.mean =</span> <span class="kw">mean</span>(hwy), <span class="dt">displ.mean =</span> (<span class="kw">mean</span>(displ)))</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co"># call to ggplot, note that data and aesthetics are called in each geom layer</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="kw">ggplot</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="st">  </span><span class="co"># first layer</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">data =</span> <span class="kw">filter</span>(mpg, class <span class="op">==</span><span class="st"> &quot;suv&quot;</span>, year <span class="op">==</span><span class="st"> </span><span class="dv">2008</span>),</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">           <span class="kw">aes</span>(<span class="dt">x =</span> manufacturer, </a>
<a class="sourceLine" id="cb7-15" data-line-number="15">               <span class="dt">y =</span> hwy, </a>
<a class="sourceLine" id="cb7-16" data-line-number="16">               <span class="dt">color =</span> displ),</a>
<a class="sourceLine" id="cb7-17" data-line-number="17">           <span class="dt">width =</span> <span class="fl">0.1</span>,</a>
<a class="sourceLine" id="cb7-18" data-line-number="18">           <span class="dt">size =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="st">  </span><span class="co"># second layer</span></a>
<a class="sourceLine" id="cb7-20" data-line-number="20"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="dt">data =</span> mpg_<span class="dv">5</span>,</a>
<a class="sourceLine" id="cb7-21" data-line-number="21">             <span class="kw">aes</span>(<span class="dt">x =</span> manufacturer,</a>
<a class="sourceLine" id="cb7-22" data-line-number="22">                 <span class="dt">ymin =</span> hwy.mean,</a>
<a class="sourceLine" id="cb7-23" data-line-number="23">                 <span class="dt">ymax =</span> hwy.mean,</a>
<a class="sourceLine" id="cb7-24" data-line-number="24">                 <span class="dt">color =</span> displ.mean),</a>
<a class="sourceLine" id="cb7-25" data-line-number="25">             <span class="dt">alpha =</span> <span class="fl">0.5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-26" data-line-number="26"><span class="st">  </span><span class="co"># customize plot labels</span></a>
<a class="sourceLine" id="cb7-27" data-line-number="27"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Fuel Economy for 2008 SUVs by Manufacturer and Engine Displacement&quot;</span>,</a>
<a class="sourceLine" id="cb7-28" data-line-number="28">       <span class="dt">color =</span> <span class="st">&quot;Disp (L)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-29" data-line-number="29"><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;highway fuel economy (miles/gal)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-30" data-line-number="30"><span class="st">  </span><span class="co"># add a fancy color scale</span></a>
<a class="sourceLine" id="cb7-31" data-line-number="31"><span class="st">  </span><span class="kw">scale_color_viridis_c</span>(<span class="dt">option =</span> <span class="st">&quot;D&quot;</span>, <span class="dt">direction =</span> <span class="dv">-1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb7-32" data-line-number="32"><span class="st">  </span><span class="co"># adopt a theme without grey background</span></a>
<a class="sourceLine" id="cb7-33" data-line-number="33"><span class="st">  </span><span class="kw">theme_classic</span>() </a></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:mpg-5"></span>
<img src="04-dataviz_files/figure-html/mpg-5-1.png" alt="A two-layer (two `geom`) plot with cusomization" width="672" />
<p class="caption">
Figure 4.6: A two-layer (two <code>geom</code>) plot with cusomization
</p>
</div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># ggsave(filename = &quot;./images/mpg-5.png&quot;, dpi = 150, device = png())</span></a></code></pre></div>
<p>What conclusions can you draw from examining Figure <a href="dataviz.html#fig:mpg-5">4.6</a>?</p>
</div>
<div id="store-and-save-ggplot2-objects" class="section level2">
<h2><span class="header-section-number">4.5</span> Store and save ggplot2 objects</h2>
<p>Sometimes you will want to store a ggplot2 plot as an object in your global environment (so that it can be called or manipulated later on). This is done in the same way as you would create and assign a name to any other object in R.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># create a ggplot object called &quot;plot1&quot;</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2">plot1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> class)) <span class="op">+</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="kw">geom_bar</span>()</a></code></pre></div>
<div class="rmdnote">
<p>
When you create and store a <code>ggplot</code> object (<code>plot1 &lt;- ggplot(data = mpg….</code>) the plot itself will be created and stored but not returned as output. If you want to “see” the plot, just enter its name into the console or script.
</p>
</div>
<p>You can also save <code>ggplot2</code> plots as image files to a local directory using the <code>ggsave</code> function. This function requires a filename but also allows you to specify paramaters like image resolution (<code>dpi = 300</code>), image type (<code>device = png()</code>), and image <code>height</code>, <code>width</code> and <code>units</code> of measurement.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># create a ggplot object called &quot;plot1&quot;</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">plot1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> mpg, <span class="kw">aes</span>(<span class="dt">x =</span> class)) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="kw">geom_bar</span>()</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="kw">ggsave</span>(<span class="st">&quot;./images/mpg-1.png&quot;</span>,</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">       <span class="dt">plot =</span> plot1,</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">       <span class="dt">dpi =</span> <span class="dv">150</span>,</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">       <span class="dt">device =</span> <span class="kw">png</span>(),</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">       <span class="dt">width =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">       <span class="dt">units =</span> <span class="st">&quot;cm&quot;</span>)</a></code></pre></div>
</div>
<div id="getting-help-with-ggplot2" class="section level2">
<h2><span class="header-section-number">4.6</span> Getting help with ggplot2</h2>
<p>The <code>ggplot2</code> package has become so popular that most of my “how do I do this?” questions have already been asked, answered, and archived on sites like <a href="https://stackoverflow.com/">stackoverflow</a>. Another great source is the ggplot2 reference section on the <a href="https://ggplot2.tidyverse.org/reference/index.html">Tidyverse site</a>. This page contains a nice, concise summary of how to call and customize plot objects. I reccommend starting there because (1) it is created and maintained by the <code>ggplot2</code> developers (and, thus, is authoritative) and (2) the reference page contains all the function calls in an organized list, for which you can conduct a ‘control/command F’ search.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="rprog2.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="eda1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
