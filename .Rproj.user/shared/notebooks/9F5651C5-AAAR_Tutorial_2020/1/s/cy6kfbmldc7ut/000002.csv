"0","#create an arbitrary ""decay"" time-series with 1-second resolution"
"0","series_1 <- tibble(time_index = seq(1,1000,1),"
"0","                      conc = 1000/(time_index+100)) "
"0","#create an arbitrary ""exponential rise"" time-series"
"0","series_2 <- tibble(time_index = seq(1001,2000,1),"
"0","                        conc = series_1$conc[1000] + 10*exp(-200/(time_index-999)))"
"0",""
"0","#combine the two series "
"0","time_series <- bind_rows(series_1, series_2) %>%"
"0","  mutate(elapsed_time = duration(time_index, units = ""seconds""),"
"0","         clock_time = now() + elapsed_time,"
"0","         offset = elapsed_time/50,"
"0","         delay_time = clock_time + offset)"
"0",""
"0","#create 30-sec time averages"
"0","conc_correct <- time_series %>%"
"0","  group_by(avg_window = round_date(clock_time, unit = ""30 seconds"")) %>%"
"0","  summarise(mean = mean(conc))"
"0",""
"0","conc_delay <- time_series %>%"
"0","  group_by(avg_window = round_date(delay_time, unit = ""30 seconds"")) %>%"
"0","  summarise(mean_delay = mean(conc))"
"0",""
"0","all_data <- left_join(conc_correct, conc_delay, by = ""avg_window"")"
"0",""
"0","one_to_one <- ggplot(data = all_data) +"
"0","  geom_point(aes(x = mean, y = mean_delay),"
"0","             fill = 1,"
"0","             alpha = 0.25,"
"0","             color = ""blue"")+"
"0","  geom_abline(slope = 1, "
"0","              intercept = 0,"
"0","              color = ""grey"") +"
"0","  labs(x = ""Conc (accurate clock)"", y = expression(paste(""Conc, drift = 0.02 s"" ^ -1))) +"
"0","  theme_bw()"
"0",""
"0","time_series <- ggplot(data = time_series) +"
"0","  geom_point(aes(x = clock_time, y = conc)) +"
"0","  labs(x = ""Time"", y = ""Concentration"") +"
"0","  theme_bw() "
"0","  "
"0","one_to_one +"
"0","  annotation_custom(grob=ggplotGrob(time_series), "
"0","                      ymin = 5, ymax=9.5, xmin=0.75, xmax=5)"
"0",""
