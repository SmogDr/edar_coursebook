"0","library(dplyr)"
"0","library(ggplot2)"
"0",""
"0","# use dplyr to create a summary subset from the mpg dataframe"
"0","mpg_5 <- mpg %>%"
"0","  filter(class == ""suv"", year == 2008) %>%"
"0","  group_by(manufacturer) %>%"
"0","  summarise(hwy.mean = mean(hwy), displ.mean = mean(displ))"
"0",""
"0","# call to ggplot, note that data and aesthetics are called in each geom layer"
"0","ggplot() +"
"0","  # first layer"
"0","  geom_jitter(data = filter(mpg, class == ""suv"", year == 2008),"
"0","           aes(x = manufacturer, "
"0","               y = hwy, "
"0","               color = displ),"
"0","           width = 0.1,"
"0","           size = 2) +"
"0","  # second layer"
"0","  geom_errorbar(data = mpg_5,"
"0","             aes(x = manufacturer,"
"0","                 ymin = hwy.mean,"
"0","                 ymax = hwy.mean,"
"0","                 color = displ.mean),"
"0","             alpha = 0.5,"
"0","             size = 1) +"
"0","  # customize plot labels"
"0","  labs(title = ""Fuel Economy for 2008 SUVs by Manufacturer and Engine Displacement"","
"0","       color = ""Disp (L)"") +"
"0","  ylab(""highway fuel economy (miles/gal)"") +"
"0","  # add a fancy color scale"
"0","  scale_color_viridis_c(option = ""D"", direction = -1) +"
"0","  # adopt a theme without grey background"
"0","  theme_classic() "
